<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.14.2","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":{"gitalk":{"order":-1}},"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="renmale-lv blog">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="renmale-lv blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="renmale-lv">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>renmale-lv blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style><link rel="alternate" href="/atom.xml" title="renmale-lv blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">renmale-lv blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">记录学习点滴</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="renmale-lv"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">renmale-lv</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/20233/05/10/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="renmale-lv">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="renmale-lv blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | renmale-lv blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/20233/05/10/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" class="post-title-link" itemprop="url">网络编程</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 20233-05-10 01:20:48" itemprop="dateCreated datePublished" datetime="20233-05-10T01:20:48+08:00">20233-05-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-05-10 13:01:00" itemprop="dateModified" datetime="2023-05-10T13:01:00+08:00">2023-05-10</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>0</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <meta name="referrer" content="no-referrer">


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/09/05/%E7%AC%AC%E4%B8%80%E7%AB%A0%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="renmale-lv">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="renmale-lv blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | renmale-lv blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/09/05/%E7%AC%AC%E4%B8%80%E7%AB%A0%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/" class="post-title-link" itemprop="url">第一章 计算机系统概述</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2023-09-05 12:27:13 / Modified: 21:03:46" itemprop="dateCreated datePublished" datetime="2023-09-05T12:27:13+08:00">2023-09-05</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>4.3k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>4 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <meta name="referrer" content="no-referrer">

<h2 id="1-1操作系统的基本概念-Operating-System"><a href="#1-1操作系统的基本概念-Operating-System" class="headerlink" title="1.1操作系统的基本概念 Operating System"></a>1.1操作系统的基本概念 Operating System</h2><h3 id="操作系统的概念"><a href="#操作系统的概念" class="headerlink" title="操作系统的概念"></a>操作系统的概念</h3><ul>
<li>控制和管理整个计算机系统的硬件与软件资源，合理地组织、调度计算机的工作与资源的分配，进而为用户和其他软件提供方便接口与环境的程序的集合</li>
<li>操作系统是计算机系统中最基本的系统软件</li>
<li>计算机系统自上而下可大致分为4部分<ul>
<li>硬件、操作系统、应用程序、用户</li>
</ul>
</li>
</ul>
<h3 id="操作系统的特征"><a href="#操作系统的特征" class="headerlink" title="操作系统的特征"></a>操作系统的特征</h3><ul>
<li>并发<ul>
<li>并发是指两个或多个事件在<strong>同一个时间间隔</strong>内发生</li>
<li>并发 和 并行 的区别：注意与并行（<strong>同一时刻</strong>）的区别</li>
</ul>
</li>
<li>共享<ul>
<li>互斥共享方式：比如打印机、磁带机虽然可以供多个进程使用，但是一段时间内只运行一个进程访问该资源</li>
<li>同时访问方式：比如键盘等</li>
</ul>
</li>
<li><p>虚拟</p>
<ul>
<li>虚拟是指把一个物理上的实体变为若干逻辑上的对应物</li>
<li>虚拟技术<ul>
<li>时分复用技术，如处理器的分时共享</li>
<li>空分复用技术，如虚拟存储器</li>
</ul>
</li>
</ul>
</li>
<li><p>异步</p>
</li>
<li><p>操作系统两个最基本的特征是——并发和共享</p>
</li>
</ul>
<h3 id="操作系统的目标和功能"><a href="#操作系统的目标和功能" class="headerlink" title="操作系统的目标和功能"></a>操作系统的目标和功能</h3><h4 id="操作系统作为计算机系统资源的管理者"><a href="#操作系统作为计算机系统资源的管理者" class="headerlink" title="操作系统作为计算机系统资源的管理者"></a>操作系统作为计算机系统资源的管理者</h4><ul>
<li>处理机管理</li>
<li>存储器管理</li>
<li>文件管理</li>
<li>设备管理</li>
</ul>
<h4 id="操作系统作为用户与计算机硬件系统之间的接口"><a href="#操作系统作为用户与计算机硬件系统之间的接口" class="headerlink" title="操作系统作为用户与计算机硬件系统之间的接口"></a>操作系统作为用户与计算机硬件系统之间的接口</h4><ul>
<li>命令接口<ul>
<li>脱机命令接口 | 批处理命令接口 —— 适用于批处理系统</li>
<li>联机命令接口 | 交互式命令接口 —— 适用于分时或实时系统的接口</li>
</ul>
</li>
<li>程序接口<ul>
<li>概念：程序接口由一系列系统调用（也称广义指令）组成</li>
<li>应用：图形用户界面 GUI</li>
<li>用户通过在程序中使用这些系统调用来请求操作系统为其提供服务</li>
</ul>
</li>
</ul>
<h4 id="操作系统实现了对计算机资源的扩充"><a href="#操作系统实现了对计算机资源的扩充" class="headerlink" title="操作系统实现了对计算机资源的扩充"></a>操作系统实现了对计算机资源的扩充</h4><ul>
<li>没有任何软件支持的计算机称为裸机</li>
<li>把覆盖了软件的机器称为扩充机器或虚拟机</li>
</ul>
<h3 id="库函数和系统调用"><a href="#库函数和系统调用" class="headerlink" title="库函数和系统调用"></a>库函数和系统调用</h3><p>库函数是语言或应用程序的一部分，可以运行在用户空间中</p>
<p>而系统调用是操作系统的一部分，是内核为用户提供的程序接口，运行在内核空间中，而且许多库函数都会使用系统调用来实现功能<br>未使用系统调用的库函数，其执行效率通常要比系统调用的高。因为使用系统调用时，需要上下文的切换及状态的转换（由用户态转向核心态）</p>
<h2 id="1-2-操作系统的发展与分类"><a href="#1-2-操作系统的发展与分类" class="headerlink" title="1.2 操作系统的发展与分类"></a>1.2 操作系统的发展与分类</h2><ul>
<li>手工操作阶段<ul>
<li>人机矛盾（速度和资源利用）越来越大</li>
<li>缺点<ul>
<li>用户独占全机，虽然不会出现因资源已被其他用户占用而等待的现象，但资源利用率低</li>
<li>CPU等待手工操作，CPU的利用不充分</li>
</ul>
</li>
</ul>
</li>
<li>批处理阶段<ul>
<li>单道批处理系统<ul>
<li>自动性 ~在顺利的情况下，磁带上的一批作业能自动逐个运行，无须人工干预~</li>
<li>顺序性 ~磁带上的各道作业顺序地进入内存，各道作业的完成顺序与它们进入内存的顺序在正常情况下完全相同，即先调入内存的作业先完成~</li>
<li>单道性 ~内存中仅有一道程序运行，即监督程序每次从磁带上只调入一道程序进入内存运行，当该程序完成或发生异常时，才换入后继程序~</li>
</ul>
</li>
<li>多道批处理<ul>
<li>多道~计算机内存中同时存放多道相互独立的程序~ </li>
<li>宏观上并行~同时进入系统的多道程序都处于运行过程中，即它们先后开始各自的运行，但都未运行完毕~</li>
<li>微观上串行~内存中的多道程序轮流占用着CPU，交替执行~</li>
<li>优点：资源利用率高，吞吐量大</li>
<li>缺点：用户响应时间长，不提供人机交互能力</li>
</ul>
</li>
</ul>
</li>
<li>分时操作系统<ul>
<li>按时间片轮流把处理器分配给各联机作业使用</li>
<li>特征<ul>
<li>同时性（多路性）~多个终端用户同时使用一台计算机~</li>
<li>交互性</li>
<li>独立性~多个用户彼此独立地进行操作~</li>
<li>及时性</li>
</ul>
</li>
<li>响应时间 T ≈ QN<ul>
<li>时间片一定的时候，用户数越多，响应时间越长</li>
<li>含义：T是响应时间，Q是时间片，N是用户数</li>
</ul>
</li>
<li>较好地解决了人机交互问题</li>
</ul>
</li>
<li>实时操作系统<ul>
<li>硬实时系统——某个动作必须绝对地在规定的时刻发生</li>
<li>软实时系统——能够接受偶尔违反时间规定且不会引起任何永久性的损害</li>
<li>特点：及时性、可靠性+</li>
</ul>
</li>
<li>网络操作系统和分布式操作系统</li>
<li>个人计算机操作系统<ul>
<li>此外还有嵌入式操作系统，服务操作系统，智能手机操作系统</li>
</ul>
</li>
</ul>
<h2 id="1-3-操作系统的运行环境"><a href="#1-3-操作系统的运行环境" class="headerlink" title="1.3 操作系统的运行环境"></a>1.3 操作系统的运行环境</h2><h3 id="操作系统的运行机制"><a href="#操作系统的运行机制" class="headerlink" title="操作系统的运行机制"></a>操作系统的运行机制</h3><ul>
<li>程序分类<ul>
<li>操作系统内核程序：执行特权指令<ul>
<li>特权指令：指计算机中不允许被用户直接使用的指令</li>
</ul>
</li>
<li>用户自编程序（应用程序）<ul>
<li>非特权指令：允许用户直接使用的指令~它不能直接访问系统中的软硬件资源，仅限于访问用户的地址空间~</li>
</ul>
</li>
<li>内核程序 是 应用程序 的管理程序</li>
</ul>
</li>
<li>CPU 状态<ul>
<li>用户态 / 目态<ul>
<li>可以在用户态下执行的指令 ↓<ul>
<li>读时钟指令（置时钟不行）</li>
<li>取数指令</li>
<li>寄存器清零指令</li>
<li>算术运算</li>
<li>访管指令<ul>
<li>访管中断<ul>
<li><strong>访管指令</strong>是一条可以在<strong>用户态</strong>下执行的指令。在用户程序中，因要求操作系统提供服务而有意识地使用访管中断，从而产生一个中断事件（自愿中断），将操作系统转换为<strong>核心态</strong>，称为访管中断</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>核心态/管态/内核态<ul>
<li>只能在核心态执行的指令―输入/输出指令 系统调用（广义指令）</li>
</ul>
</li>
<li>CPU 状态之间的转换<ul>
<li>用户态 —&gt; 内核态―中断、异常、访管指令——由硬件完成</li>
<li>内核态 —&gt; 用户态―设置程序状态字</li>
</ul>
</li>
</ul>
</li>
<li>大多数操作系统的内核分为 4 方面内容<ul>
<li>时钟管理</li>
<li>中断机制</li>
<li>原语 Atomic Operation<ul>
<li>处于操作系统的最底层，是最接近硬件的部分</li>
<li>这些程序的运行具有原子性，其操作只能一气呵成（主要从系统安全性和便于管理考虑），不能中断</li>
<li>这些程序的运行时间较短</li>
</ul>
</li>
<li>系统控制的数据结构及处理<ul>
<li>进程管理：进程状态管理、进程调度和分配、创建与撤销进程控制块等</li>
<li>存储器管理：存储器的空间分配和回收、内存信息保护程序、代码对换程序等</li>
<li>设备管理：缓冲区管理、设备分配和回收等</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="中断和异常的概念"><a href="#中断和异常的概念" class="headerlink" title="中断和异常的概念"></a>中断和异常的概念</h3><ul>
<li><p>中断和异常的定义</p>
<ul>
<li>中断也称外中断，指来自 CPU 执行指令以外的事件的发生，如设备发出的 I/O 结束中断或时钟中断<ul>
<li>可屏蔽中断~通过INTR线发出的中断~</li>
<li>不可屏蔽中断~通过NMI线发出的中断~</li>
<li>属于硬件中断</li>
</ul>
</li>
<li>异常也称内中断，指源自 CPU 执行指令内部的事件，如程序的非法操作码、地址越界、算术溢出、虚存系统的缺页及专门的陷入指令，比如访管指令<ul>
<li>软件中断（程序性异常）<ul>
<li>故障——通常是由指令执行引起的异常</li>
<li>自陷——一种事先安排的“异常”事件，用于在用户态下调用操作系统内核程序</li>
</ul>
</li>
<li>硬件中断</li>
<li>终止——出现了使得CPU无法继续执行的硬件故障</li>
</ul>
</li>
</ul>
</li>
<li><p>中断处理的过程 ↓</p>
<ol>
<li>关中断（中断状态寄存器）</li>
<li>保存断点：程序计数器 PC</li>
<li>中断服务程序寻址：程序状态字寄存器 PSWR</li>
<li>保存现场和屏蔽字</li>
<li>开中断</li>
<li>执行中断程序服务</li>
<li>关中断</li>
<li>恢复现场和屏蔽字</li>
<li>开中断、中断返回</li>
</ol>
<ul>
<li>1-3 步是在 CPU 进入中断周期后，由硬件自动（中断隐指令）完成</li>
<li>4-9 步由中断服务程序完成</li>
</ul>
</li>
<li><p>系统调用</p>
<ul>
<li>设备管理——完成设备的请求或释放，以及设备启动等功能</li>
<li>文件管理——完成文件的读、写、创建及删除等功能</li>
<li>进程控制——完成进程的创建、撤销、阻塞及唤醒等功能</li>
<li>进程通信——完成进程之间的消息传递或信号传递等功能</li>
<li>内存管理——完成内存的分配、回收以及获取作业占用内存区大小及始址等功能</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202308242018667.png" alt="image-20230824201838196"></li>
</ul>
</li>
</ul>
<h2 id="1-4-操作系统的体系结构"><a href="#1-4-操作系统的体系结构" class="headerlink" title="1.4 操作系统的体系结构"></a>1.4 操作系统的体系结构</h2><h3 id="分层结构"><a href="#分层结构" class="headerlink" title="分层结构"></a>分层结构</h3><ul>
<li>将操作系统分为若干层，最底层是硬件，最高层为用户接口</li>
<li>每层只能调用紧邻它的低层的功能和服务（单向依赖）</li>
<li>优点：<ul>
<li>便于系统的调试和验证，简化了系统的设计和实现</li>
<li>易扩充和易维护</li>
</ul>
</li>
<li>问题：<ul>
<li>仅可调用相邻底层，难以合理定义各层的边界</li>
<li>效率低，不可跨层调用，系统调用执行时间长</li>
</ul>
</li>
</ul>
<h3 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h3><ul>
<li>模块化是将操作系统按功能划分为若干具有一定独立性的模块</li>
<li>衡量独立性标准<ul>
<li>内聚性，模块内部各部分间联系的紧密程度。内聚性越高，模块独立性越好</li>
<li>耦合度，模块间相互联系和相互影响的程度。耦合度越低，模块独立性越好</li>
</ul>
</li>
<li>优点：<ul>
<li>提高了操作系统设计的正确性、可理解性和可维护性</li>
<li>增强了操作系统的可适应性</li>
<li>加速了操作系统的开发过程</li>
</ul>
</li>
<li>缺点：<ul>
<li>模块间的接口规定很难满足对接口的实际需求</li>
<li>各模块设计者齐头并进，每个决定无法建立在上一个已验证的正确决定的基础上，因此无法找到一个可靠的决定顺序</li>
</ul>
</li>
</ul>
<h3 id="大内核和微内核"><a href="#大内核和微内核" class="headerlink" title="大内核和微内核"></a>大内核和微内核</h3><ul>
<li>大内核（宏内核/单内核）<ul>
<li>将操作系统的主要功能模块都作为系统内核，运行在核心态</li>
<li>优点：高性能</li>
<li>缺点：内核代码庞大，结构混论，难以维护</li>
<li>Linux、UNIX</li>
</ul>
</li>
<li>微内核<ul>
<li>只把最基本的功能保留在内核</li>
<li>将操作系统划分为两大部分<ul>
<li>微内核<ul>
<li>精心设计的、能实现操作系统最基本核心功能的小型内核<ul>
<li>与硬件处理紧密相关的部分</li>
<li>一些较基本的问题</li>
<li>客户和服务器之间的通信</li>
</ul>
</li>
</ul>
</li>
<li>多个服务器<ul>
<li>运行在用户态</li>
</ul>
</li>
</ul>
</li>
<li>基本功能<ul>
<li>进程（线程）管理</li>
<li>低级存储器管理</li>
<li>中断和陷入处理</li>
</ul>
</li>
<li>优点<ul>
<li>扩展性和灵活性</li>
<li>可靠性和安全性</li>
<li>可移植性</li>
<li>分布式计算</li>
</ul>
</li>
<li>缺点：需要频繁地在核心态和用户态之间切换，性能低</li>
<li>微内核结构通常利用”机制与策略分离“的原理来构造内核OS结构，基于C/S模式</li>
<li>Windows NT</li>
</ul>
</li>
</ul>
<h3 id="外核"><a href="#外核" class="headerlink" title="外核"></a>外核</h3><ul>
<li>外核负责为用户进程分配未经抽象的硬件资源，且有外核负责资源使用安全</li>
<li>优点<ul>
<li>外核可直接给用户进程分配“不虚拟、不抽象”的硬件资源，使用户进程可以更灵活的使用硬件资源</li>
<li>减少了虚拟硬件资源的“映射层”。提高效率</li>
</ul>
</li>
<li>缺点<ul>
<li>降低了系统的一致性</li>
<li>使系统变得更复杂 </li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/renmale-sztu/image/raw/master/202308251654601.png" alt="image-20230825165435284"></p>
<h2 id="1-5-操作系统引导"><a href="#1-5-操作系统引导" class="headerlink" title="1.5 操作系统引导"></a>1.5 操作系统引导</h2><ul>
<li>激活CPU ~激活的CPU读取ROM中的boot程序，将指令寄存器置为BIOS（基本输入/输出系统）的第一条指令，即开始执行BIOS的指令~</li>
<li>硬件自检~启动BIOS程序后，先进行硬件自检，检查硬件是否出现故障，如有故障，主板会发出不同含义的蜂鸣，启动中止；如无故障，屏幕会显示CPU、内存、硬盘等信息~</li>
<li>加载带有操作系统的硬盘~硬件自检后，BIOS开始读取Boot\ Sequence（通过CMOS里保存的启动顺序，或者通过与用户交互的方式），把控制权交给启动顺序排在第一位的存储设备，然后CPU将该存储设备引导扇区的内容加载到内存中~</li>
<li>加载主引导记录MBR~硬盘以特定的标识符区分引导硬盘和非引导硬盘。如果发现一个存储设备不是可引导盘，就检查下一个存储设备。如无其他启动设备，就会死机。主引导记录MBR的作用是告诉CPU去硬盘的哪个主分区去找操作系统~</li>
<li>扫描硬盘风区表，并加载硬盘活动分区~MBR包含硬盘分区表，硬盘分区表以特定的标识符号区分活动分区和非活动分区。主引导记录扫描硬盘分区表，进而识别含有操作系统的硬盘分区（活动分区）。找到硬盘活动分区后，开始加载硬盘活动分区，将控制权交给活动分区~</li>
<li>加载分区引导记录PBR~读取活动分区的第一个扇区，这个扇区称为分区引导记录（PBR），其作用是寻找并激活分区根目录下用于引导操作系统的程序（启动管理器）~</li>
<li>加载启动管理器~分区引导记录搜索活动分区中的启动管理器，加载启动管理器~</li>
<li>加载操作系统</li>
</ul>
<h2 id="1-6-虚拟机"><a href="#1-6-虚拟机" class="headerlink" title="1.6 虚拟机"></a>1.6 虚拟机</h2><ul>
<li>虚拟即是一台逻辑计算机，是指利用特殊的虚拟化技术，通过隐藏特定计算平台的实际物理特性，为用户提供抽象的、统一的、模拟的计算环境</li>
<li><strong>第一类虚拟机管理程序</strong><ul>
<li>就像一个操作系统，是唯一一个运行在最高特权级的程序，在裸机上运行并且具有多道程序功能</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202308251731029.png" alt="image-20230825173133557"></li>
</ul>
</li>
<li><strong>第二类虚拟机管理程序</strong><ul>
<li>VMware Workstation</li>
<li>运行在两类虚拟机管理程序上的操作系统都称为客户操作系统，对于第二类，运行在底层的操作系统称为宿主操作系统</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202308251731357.png" alt="image-20230825173147236"></li>
</ul>
</li>
<li>虚拟机作为用户态的一个进程运行，不允许执行敏感指令</li>
<li>虚拟机上的操作系统认为自己运行在内核态（实际不是），称为虚拟内核态</li>
<li>虚拟机中的用户进程认为自己运行在用户态（实际上确实是）</li>
<li>当虚拟操作系统执行一条特权指令时，会陷入虚拟机管理程序</li>
</ul>
<p><img src="https://gitee.com/renmale-sztu/image/raw/master/202308251702236.png" alt="image-20230825170205827"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/09/05/%E7%AC%AC%E4%B8%80%E7%AB%A0%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="renmale-lv">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="renmale-lv blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | renmale-lv blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/09/05/%E7%AC%AC%E4%B8%80%E7%AB%A0%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/" class="post-title-link" itemprop="url">第一章 计算机系统概述</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2023-09-05 12:27:13 / Modified: 21:04:03" itemprop="dateCreated datePublished" datetime="2023-09-05T12:27:13+08:00">2023-09-05</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>2.2k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>2 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <meta name="referrer" content="no-referrer">

<h2 id="1-1-计算机发展历程（不考察）"><a href="#1-1-计算机发展历程（不考察）" class="headerlink" title="1.1 计算机发展历程（不考察）"></a>1.1 计算机发展历程（不考察）</h2><ul>
<li>计算机硬件的发展<ul>
<li>第一代计算机——电子管时代</li>
<li>第二代计算机——晶体管时代</li>
<li>第三代计算机——中小规模集成电路时代</li>
<li>第四代计算机——超大规模集成电路时代</li>
<li>摩尔定律——价格不变时，集成电路上可容纳的==晶体管数目==，约每隔==18个月==增长一倍</li>
</ul>
</li>
</ul>
<h2 id="1-2-计算机系统层次结构"><a href="#1-2-计算机系统层次结构" class="headerlink" title="1.2 计算机系统层次结构"></a>1.2 计算机系统层次结构</h2><p><strong>计算机系统的组成</strong></p>
<ul>
<li>硬件系统</li>
<li>软件系统</li>
</ul>
<p><strong>计算机硬件的基本组成</strong></p>
<ul>
<li>冯诺依曼机 <ul>
<li>采用 “存储程序” 的工作方式 —— 将指令以代码的形式事先输入计算机主存储器，然后按其在存储器中的首地址执行程序的第一条指令，以后就按该程序的的规定顺序执行其他指令，直至程序结束</li>
<li>运算器 + 存储器 + 控制器 + 输入设备 + 输出设备</li>
<li>指令和数据以同等地位存储在存储器中，但计算机能够区分它们（指令周期的不同阶段）</li>
<li>指令和数据君用二进制代码表示</li>
<li>控制流驱动方式</li>
<li>五大功能<ul>
<li>数据传送功能</li>
<li>数据存储功能</li>
<li>数据处理功能</li>
<li>操作控制功能</li>
<li>操作判断功能</li>
</ul>
</li>
</ul>
</li>
<li>计算机的功能部件<ul>
<li>输入设备 —— 将程序和数据以机器能够识别和接受的信息形式输入计算机</li>
<li>输出设备</li>
<li>存储器<ul>
<li>主存储器（内存储器）<ul>
<li>CPU能够直接访问</li>
<li>组成<ul>
<li>地址寄存器（MAR）~存放访存地址~<ul>
<li>~MAR的位数对应着存储单元的个数~</li>
<li>~MAR的长度与PC的长度相等~</li>
</ul>
</li>
<li>数据寄存器（MDR）~用于暂存要从存储器中读或写的信息~<ul>
<li>~MDR的长度和存储字长相等~</li>
</ul>
</li>
<li>时序控制逻辑 ~产生存储器操作所需的各种时序信号~</li>
<li>存储体 ~包含若干存储单元，每个存储单元包含若干存储元件，每个存储元件存储一位二进制代码~</li>
</ul>
</li>
</ul>
</li>
<li>辅助存储器（外存储器）</li>
</ul>
</li>
<li>运算器<ul>
<li>组成<ul>
<li>算术逻辑单元 ALU（核心）</li>
<li>累加寄存器 ACC</li>
<li>乘商寄存器 MQ</li>
<li>操作数寄存器 X</li>
<li>变址寄存器 IX</li>
<li>基址寄存器 BR</li>
<li>程序状态字寄存器 PSW ~结果是否溢出，有无产生进位或错位，结果是否为负~</li>
</ul>
</li>
</ul>
</li>
<li>控制器<ul>
<li>控制器是计算机的指挥中心</li>
<li>组成<ul>
<li>程序计数器 PC ~存放当前欲执行指令的地址，有自动加1的功能~</li>
<li>指令寄存器  IR ~存放当前的指令，其内容来自MDR，指令中操作码OP(IP)送至CU，地址码Ad(IR)送完MAR~</li>
<li>控制单元 CU</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>冯诺依曼模型机<ul>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202308232302523.png" alt="image-20230823230159565"> </li>
<li>CPU包括ALU、通用寄存器组GRPs、标志寄存器、控制器、指令寄存器IR、程序计数器PC、存储器地址寄存器MAR和存储器数据寄存器MAR</li>
<li>虚线是控制信号<ul>
<li>控制如何修改PC得到下一条指令的地址</li>
<li>控制ALU执行什么运算</li>
<li>控制主存进行读操作还是写操作</li>
</ul>
</li>
<li>CPU和主存之间通过一组总线相连，总线中有地址、控制、数据3组信号线</li>
</ul>
</li>
</ul>
<p><strong>计算机软件</strong></p>
<ul>
<li><p>软件分类</p>
<ul>
<li>系统软件<ul>
<li>操作系统 Operating System</li>
<li>数据库管理系统 DBMS</li>
<li>语言处理程序</li>
<li>分布式软件系统</li>
<li>网络软件系统</li>
<li>标准库系统</li>
<li>服务性程序</li>
</ul>
</li>
<li>应用软件</li>
</ul>
</li>
<li>数据库管理系统（DBMS）和数据库系统（DBS）不一样<ul>
<li>DBMS是位于用户和操作系统之间的一层数据管理软件，是系统软件</li>
<li>DBS是指计算机系统引入数据库后的系统，一般由数据库、数据库管理系统、数据库管理员（DBA）和应用系统构成</li>
</ul>
</li>
<li>三个级别的语言<ul>
<li>机器语言——计算机唯一可以直接识别和执行的语言</li>
<li>汇编语言</li>
<li>高级语言</li>
</ul>
</li>
<li>翻译程序<ul>
<li>汇编程序（汇编器）——汇编语言 —&gt; 机器语言</li>
<li>解释程序（解释器）——将源程序中的语句逐条翻译成机器指令并立即执行——速度较慢</li>
<li>编译程序（编译器）——高级语言 —&gt; 汇编语言/机器语言——编译时间较长，运行速度较快</li>
</ul>
</li>
<li>软件和硬件的逻辑等价性<ul>
<li>硬件实现的往往是最基本的算术和逻辑运算功能</li>
</ul>
</li>
</ul>
<p><strong>计算机系统的层次结构</strong></p>
<p><img src="https://gitee.com/renmale-sztu/image/raw/master/202308232315086.png" alt="image-20230823231515391"></p>
<ul>
<li><p>计算机系统的多级层次结构 ↓ </p>
<ul>
<li><p>第1级：微程序机器层——硬件层，由机器硬件直接执行微程序</p>
</li>
<li><p>第2级：传统机器语言层——机器层，由微程序解释机器指令系统</p>
</li>
<li><p>第3级：操作系统层</p>
</li>
<li><p>第4级：汇编语言层</p>
</li>
<li><p>第5级：高级语言层</p>
</li>
<li>~应用程序层~</li>
</ul>
</li>
<li><p>裸机——没有配备软件的纯硬件系统</p>
</li>
<li><p>指令集体系结构（ISA）——软件和硬件之间的界面</p>
</li>
</ul>
<p><strong>计算机系统的工作原理</strong></p>
<ul>
<li>“存储程序”工作方式<ul>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202308232320099.png" alt="image-20230823232031745"></li>
<li>执行前，需要将程序所含的指令和数据送入主存</li>
<li>指令执行过程：<ul>
<li>从主存取地址</li>
<li>对指令进行译码</li>
<li>计算下条指令地址</li>
<li>取操作数并执行</li>
<li>将结果送回存储器</li>
</ul>
</li>
</ul>
</li>
<li>从源程序到可执行文件<ul>
<li>预处理阶段</li>
<li>编译阶段</li>
<li>汇编阶段</li>
<li>链接阶段</li>
</ul>
</li>
<li>指令执行过程的描述（以取数指令为例）<ul>
<li>取指令：PC→MAR→M→MDR→IR</li>
<li>分析指令：OP(IR)→CU</li>
<li>执行指令：Ad(IR)→MAR→M→MDR→ACC</li>
</ul>
</li>
<li>注意：(PC)指程序计数器PC中存放的内容<code>PC -&gt; MAR</code> 应该理解为<code>(PC)-&gt;MAR</code></li>
<li>（PC）指PC寄存器存放的地址指向的数据</li>
</ul>
<h2 id="1-3-计算机的性能指标"><a href="#1-3-计算机的性能指标" class="headerlink" title="1.3 计算机的性能指标"></a>1.3 计算机的性能指标</h2><ul>
<li>计算机的主要性能指标<ul>
<li>机器字长:——一般等于内部寄存器的大小，越长数据表示范围越大，计算精度越高</li>
<li>数据通路带宽——数据总线一次所能并行传送信息的位数</li>
<li>主存容量</li>
<li>运算速度<ul>
<li>吞吐量——系统在单位事件内处理请求的数量<ul>
<li>评价计算机性能的综合参数</li>
</ul>
</li>
<li>响应时间</li>
<li>CPU时钟周期 = 1 / 主频</li>
<li>CPI ——执行一条指令所需的时钟周期数</li>
<li>CPU执行时间 = CPU时钟周期数 / 主频 = （指令条数 × CPI）/ 主频<ul>
<li>上式表明，CPU的性能取决于：主频（时钟频率）、CPI、指令条数</li>
</ul>
</li>
<li>MIPS  每秒执行多少百万条命令</li>
<li>MFLOPS 每秒执行多少百万次浮点运算<ul>
<li>GFLOPS 每秒执行多少十亿次浮点运算</li>
<li>TFLOPS 每秒执行多少万亿次浮点运算</li>
<li>PFLOPS  10e15</li>
<li>EFLOPS  10e18</li>
<li>ZFLOPS  10e21</li>
</ul>
</li>
</ul>
</li>
<li>基准程序（Benchmarks）<ul>
<li>专门用来进行性能评价的一组程序，能够很好地反映机器在运行实际负载时的性能</li>
</ul>
</li>
</ul>
</li>
<li>几个专业术语<ul>
<li>系列机<ul>
<li>具有相同的体系结构，使用相同基本指令系统的多个不同型号的计算机组成的一个产品系列</li>
</ul>
</li>
<li>兼容<ul>
<li>软件或硬件的通用性</li>
</ul>
</li>
<li>软件可移植性</li>
<li>固件<ul>
<li>将程序固定在ROM中组成的部件称为固件</li>
</ul>
</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/09/05/%E7%AC%AC%E4%B8%89%E7%AB%A0%20%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="renmale-lv">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="renmale-lv blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | renmale-lv blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/09/05/%E7%AC%AC%E4%B8%89%E7%AB%A0%20%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/" class="post-title-link" itemprop="url">第三章 内存管理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2023-09-05 12:27:13 / Modified: 21:02:35" itemprop="dateCreated datePublished" datetime="2023-09-05T12:27:13+08:00">2023-09-05</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>9.3k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>8 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <meta name="referrer" content="no-referrer">

<h2 id="3-1-内存管理概念"><a href="#3-1-内存管理概念" class="headerlink" title="3.1 内存管理概念"></a>3.1 内存管理概念</h2><h3 id="3-1-1内存管理的基本原理和要求"><a href="#3-1-1内存管理的基本原理和要求" class="headerlink" title="3.1.1内存管理的基本原理和要求"></a>3.1.1内存管理的基本原理和要求</h3><p><strong>内存管理的功能</strong></p>
<ul>
<li><p>内存空间的分配与回收</p>
<ul>
<li>由操作系统完成主存储器空间的分配和管理，使程序员摆脱存储分配的麻烦，提高编程效率</li>
</ul>
</li>
<li><p>地址转换</p>
<ul>
<li>在多道程序环境下，程序中的逻辑地址与内存中的物理地址不可能一致，因此存储管理必须提供地址变换功能，把逻辑地址转换成相应的物理地址</li>
</ul>
</li>
<li><p>内存空间的扩充</p>
<ul>
<li>利用虚拟存储技术或自动覆盖技术，从逻辑上扩充内存</li>
</ul>
</li>
<li><p>内存共享</p>
<ul>
<li>指允许多个进程访问内存的同一部分</li>
</ul>
</li>
<li><p>存储保护</p>
<ul>
<li>保证各道作业在各自的存储空间内运行，互不干扰</li>
</ul>
</li>
</ul>
<p><strong>程序装入和链接</strong></p>
<ul>
<li>步骤<ul>
<li>编译<ul>
<li>由编译程序将用户源代码编译成若干目标模块</li>
</ul>
</li>
<li>链接<ul>
<li>由链接程序将编译后形成的一组目标模块及™所需的库函数链接在一起，形成一个完整的装入模块</li>
</ul>
</li>
<li>装入<ul>
<li>由转装入程序将装入模块装入内存运行</li>
</ul>
</li>
</ul>
</li>
<li>程序的链接方式<ul>
<li>静态链接<ul>
<li>在程序运行之前，先将各目标模块及它们所需的库函数连接成一个完整的可执行文件（装入模块），之后不再拆开</li>
</ul>
</li>
<li>装入时动态链接<ul>
<li>将各目标模块装入内存时，边装入边链接的链接方式，其优点是便于修改和更新，便于实现对目标模块的共享</li>
</ul>
</li>
<li>运行时动态链接<ul>
<li>在程序执行中需要该目标模块时，才对它进行链接，其优点是能加快程序的装入过程，还可节省大量的内存空间</li>
</ul>
</li>
</ul>
</li>
<li>内存的装入<ul>
<li>绝对装入<ul>
<li>概念<ul>
<li>在编译时，如果知道程序将放到内存中的哪个位置，编译程序将产生绝对地址的目标代码。装入程序按照装入模块中的地址，将程序和数据装入内存</li>
<li>编译和链接时就改变地址</li>
</ul>
</li>
<li>只适用于单道程序环境</li>
</ul>
</li>
<li>可重定位装入<ul>
<li>概念<ul>
<li>又称静态重定位</li>
<li>编译、链接后的装入模块的地址都是从0开始的，指令中使用的地址、数据存放的地址都是相对于起始地址而言的逻辑地址</li>
<li>可根据内存的当前情况，将装入模块装入到内存的适当位置。装入时对地址进行“重定位”，将逻辑地址变换为物理地址</li>
<li>地址变换是在装入时一次完成的</li>
</ul>
</li>
<li>必须分配其要求的全部内存空间</li>
<li>在运行期间就不能再移动</li>
</ul>
</li>
<li>动态运行时装入<ul>
<li>概念<ul>
<li>也称动态重定位</li>
<li>装入程序把装入模块装入内存后，并不会立即把逻辑地址转换为物理地址，而是把地址转换推迟到程序真正要执行时才进行</li>
<li>装入内存后所有的地址依然是逻辑地址</li>
<li>需要一个重定位寄存器的支持。</li>
</ul>
</li>
<li>可以将程序分配道不连续的存储区</li>
<li>在程序运行之前可以指装入部分代码即可投入运行，然后在程序运行期间，根据需要动态申请分配内存</li>
<li>便于程序段的共享</li>
</ul>
</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309031608870.png" alt="image-20230903160809914"></li>
</ul>
</li>
</ul>
<p><strong>逻辑地址空间与物理地址空间</strong></p>
<ul>
<li>相对地址（逻辑地址）<ul>
<li>编译后，每个目标模块都从0号单元开始编制，这称为目标模块的相对地址</li>
<li>链接程序顺序一次按各个模块的相对地址构成统一的从0号单元开始编址的逻辑地址空间（虚拟地址空间），对于32位系统，逻辑地址空间的范围为<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="11.466ex" height="2.072ex" role="img" focusable="false" viewBox="0 -833.9 5068.1 915.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g><g data-mml-node="mo" transform="translate(777.8,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g><g data-mml-node="msup" transform="translate(2055.6,0)"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(500,0)"></path></g></g></g><g data-mml-node="mo" transform="translate(3567.9,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(4568.1,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></svg></mjx-container></li>
</ul>
</li>
<li>物理地址空间<ul>
<li>内存中物理单元的集合，地址转换的最终地址</li>
</ul>
</li>
<li>地址重定位<ul>
<li>逻辑地址转换为物理地址的过程</li>
<li>通过内存管理部件（MMU）来实现</li>
</ul>
</li>
</ul>
<p><strong>进程的内存映像</strong></p>
<ul>
<li>组成<ul>
<li>代码段<ul>
<li>即程序的二进制代码，代码段是只读的，可以被多个进程共享</li>
</ul>
</li>
<li>数据段<ul>
<li>即程序运行时加工处理的对象，包括全局变量和静态变量</li>
</ul>
</li>
<li>进程控制块（PCB）<ul>
<li>存放在系统区。操作系统通过PCB来控制和管理进程</li>
</ul>
</li>
<li>栈<ul>
<li>用来存放动态分配的变量。通过调用mall oc函数动态地向高地址分配空间</li>
</ul>
</li>
<li>堆<ul>
<li>用来实现函数调用。从用户空间的最大地址往低地址方向增长</li>
</ul>
</li>
</ul>
</li>
<li>代码段和数据段在程序调入内存时就指定了大小，而堆和栈不一样</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309031607409.png" alt="image-20230903160738499"></li>
</ul>
<p><strong>内存保护</strong></p>
<ul>
<li>设置一对上、下限寄存器<ul>
<li>存放用户作业在主存中的下限和上限</li>
</ul>
</li>
<li>采用重定位寄存器（基地址寄存器）和界地址寄存器（限长寄存器）<ul>
<li>重定位地址含最小的物理地址值</li>
<li>界地址寄存器含逻辑地址的最大值</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309031607273.png" alt="image-20230903160713214"></li>
</ul>
</li>
</ul>
<p><strong>内存共享</strong></p>
<p><strong>内存分配与回收</strong></p>
<ul>
<li>单一连续分配——固定分区分配——动态分区分配</li>
<li>连续分配方式——离散分配方式（页式存储管理）</li>
<li>引入分段存储管理的目的<ul>
<li>满足用户在编程和使用方面的要求</li>
</ul>
</li>
</ul>
<h3 id="3-1-2-覆盖与交换（不要求）"><a href="#3-1-2-覆盖与交换（不要求）" class="headerlink" title="*3.1.2 覆盖与交换（不要求）"></a>*3.1.2 覆盖与交换（不要求）</h3><h3 id="3-1-3连续分配管理方式"><a href="#3-1-3连续分配管理方式" class="headerlink" title="3.1.3连续分配管理方式"></a>3.1.3连续分配管理方式</h3><ul>
<li>连续分配方式是指为一个用户程序分配一个连续的内存空间</li>
<li><p>内部碎片</p>
<ul>
<li>分配给某进程的内存区域中，有些部分没有用上</li>
</ul>
</li>
<li><p>外部碎片</p>
<ul>
<li>内存中的某些空闲分区由于太小而难以利用</li>
</ul>
</li>
</ul>
<p><strong>单一连续分配</strong></p>
<ul>
<li><p>内存被分为系统区和用户区。系统区通常位于内存的低地址部分，用于存放操作系统相关数据；用户区用于存放用户进程相关数据。内存中只能有一道用户程序，用户程序独占整个用户区空间</p>
</li>
<li><p>优点：</p>
<ul>
<li>简单、无外部碎片，无须进行内存保护</li>
</ul>
</li>
<li>缺点<ul>
<li>只能用于单用户、单任务的操作系统中，有内部碎片，存储器的利用率极低</li>
</ul>
</li>
</ul>
<p><strong>固定分区分配</strong></p>
<ul>
<li><p>将整个用户空间划分为若干个固定大小的分区，在每个分区中只装入一道作业，这样就形成了最早的、最简单的一种可运行多道程序的内存管理方式</p>
</li>
<li><p>分区方法</p>
<ul>
<li><p>分区大小相等</p>
<ul>
<li>程序太小会造成浪费，太大又无法装入，缺乏灵活性</li>
</ul>
</li>
<li><p>分区大小不等</p>
<ul>
<li>划分为多个较小的分区、适量的中等分区和少量的大分区</li>
</ul>
</li>
</ul>
</li>
<li><p>空闲分区链</p>
</li>
<li><p>分区使用表（空闲分区表）</p>
<ul>
<li>记录每个分区的起始地址、大小以及状态（是否已分配）</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309031937364.png" alt="image-20230903193754349"></li>
</ul>
</li>
<li><p>存在两个问题</p>
<ul>
<li>程序过大放不进任何一个分区中</li>
<li>主存利用率低，存在内部碎片</li>
</ul>
</li>
</ul>
<p><strong>动态分区分配（可变分区分配）</strong></p>
<ul>
<li><p>在进程装入内存时，根据进程的实际需要，动态地为之分配内存，并使分区的大小正好适合进程的需要</p>
</li>
<li><p>紧凑技术</p>
<ul>
<li>解决外部碎片问题</li>
<li>操作系统不时对进程进行移动和整理</li>
<li>需要动态重定位寄存器的支持，相对费时</li>
</ul>
</li>
<li>动态分区的分配策略<ul>
<li>首次适应算法 First Fit<ul>
<li>空闲分区以地址递增的次序链接，分配内存时，从链首开始顺序查找，找到大小能满足要求的第一个空闲分区分配作业</li>
<li>优点<ul>
<li>最简单、最快、最好</li>
</ul>
</li>
<li>缺点<ul>
<li>内存的低地址部分出现很多小的空闲分区，每次查找都要绕开这些分区，增加了开销</li>
</ul>
</li>
</ul>
</li>
<li>邻近适应算法 Next Fit<ul>
<li>又称循环首次适应算法</li>
<li>分配内存时从上次查找结束的位置开始继续查找</li>
<li>缺点<ul>
<li>可能会导致无论低地址、高地址部分的空闲分区都有相同的概率被使用，也就导致了高地址部分的大分区更可能被使用，划分为小分区，性能比首次适应算法差</li>
</ul>
</li>
</ul>
</li>
<li>最佳适应算法 Best Fit<ul>
<li>空闲分区以容量递增的次序形成空闲分区链，找到第一个能满足要求且最小的分区分配给作业</li>
<li>缺点<ul>
<li>每次分配会留下很小的难以利用的内存块，产生很多的外部碎片，性能很差</li>
</ul>
</li>
</ul>
</li>
<li>最坏适应算法 Worst Fit<ul>
<li>空闲分区以容量递减的次序链接，找到第一个能满足要求的，即最大的分区，从中分割一部分存储空间给作业</li>
<li>缺点：<ul>
<li>快速消耗大分区，导致后面无大分区可用</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="非连续分配管理方式"><a href="#非连续分配管理方式" class="headerlink" title="非连续分配管理方式"></a>非连续分配管理方式</h3><ul>
<li>分页存储管理<ul>
<li>基本分页存储管理</li>
<li>请求分页存储管理</li>
</ul>
</li>
<li>分段存储管理</li>
</ul>
<h3 id="3-1-4-基本分页存储管理方式"><a href="#3-1-4-基本分页存储管理方式" class="headerlink" title="3.1.4 基本分页存储管理方式"></a>3.1.4 基本分页存储管理方式</h3><ul>
<li><p>从计算机角度考虑，提高内存的利用率和计算机的性能，通过硬件机制实现，对用户完全透明</p>
</li>
<li><p>把主存空间划分为大小相等且固定的块，块相对较小，作为主存的基本单位，每个进程也以块为单位进行划分，进程在执行时，以块为单位逐个申请主存的块空间</p>
</li>
<li>不会产生外部碎片</li>
<li>每个进程平均只产生半个块大小的内部碎片（页内碎片）</li>
<li>不方便按照逻辑模块实现信息的共享和保护</li>
</ul>
<p><strong>分页存储的几个基本概念</strong></p>
<ul>
<li>页面和页面大小<ul>
<li>进程中的块称为页/页面（Page）<ul>
<li>大小应是2的整数幂<ul>
<li>逻辑地址的拆分更加迅速</li>
<li>物理地址的计算更加迅速</li>
</ul>
</li>
<li>过小<ul>
<li>使进程的页面数过多，这样页表就会过长，占用大量内存，而且增加硬件地址转换的开销。，降低页面换入/换出的效率</li>
</ul>
</li>
<li>过大<ul>
<li>使页内碎片增多，降低主存的利用率</li>
</ul>
</li>
</ul>
</li>
<li>内存中的块称为页框（Page Frame，或页帧）</li>
<li>外存直接称为块/盘块（Block）</li>
</ul>
</li>
<li>地址结构<ul>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309041913870.png" alt="image-20230904191338566"><ul>
<li>上图地址长度为32位，其中0-11位为页内地址，即每页大小为4KB；12-31位为页号，即最多允许<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="2.919ex" height="1.887ex" role="img" focusable="false" viewBox="0 -833.9 1290.1 833.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path></g></g></g></g></g></svg></mjx-container>页</li>
</ul>
</li>
</ul>
</li>
<li>页表<ul>
<li>实现从页号到物理块号的地址映射</li>
<li>由页表项组成</li>
<li>第一部分为页号（隐藏），第二部分是物理内存中的块号</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309041917922.png" alt="image-20230904191756167"></li>
</ul>
</li>
</ul>
<p><strong>基本地址变换机构</strong></p>
<ul>
<li>页表寄存器（PTR）<ul>
<li>存放页表在内存的起始地址F和页表长度M</li>
</ul>
</li>
<li>过程<ul>
<li>设页面大小为L，逻辑地址为A，物理地址为E</li>
<li>页号P = L/A；页内偏移量W = A%L</li>
<li>比较页号P与页面长度M，若P≥M则产生越界中断</li>
<li>页表中页号P对应的页表项地址 = 页表始址F + 页号P × 页表项长度，取出该页表项内容b，即物理块号</li>
<li>计算 物理地址E = b × L + W</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309041924860.png" alt="image-20230904192440613"></li>
</ul>
</li>
<li>页表项的大小<ul>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309041922520.png" alt="image-20230904192202285"></li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309041930281.png" alt="image-20230904193029310"></li>
</ul>
</li>
<li>分页管理方式存在的主要问题<ul>
<li>地址转换必须足够快，否咋访存速度会降低<ul>
<li>每次访存操作都需要进行逻辑地址到物理地址的转换</li>
</ul>
</li>
<li>页表不能过大，否则内存利用率会降低<ul>
<li>每个进程都要引入页表，用于存储映射机制</li>
</ul>
</li>
</ul>
</li>
<li>两次访存</li>
</ul>
<p><strong>具有快表的地址变换机构</strong></p>
<ul>
<li>高速缓冲存储器——快表（相联存储器TLB），主存中的页表常称为慢表</li>
<li>地址变换过程<ul>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309041936325.png" alt="image-20230904193657148"></li>
<li>CPU给出逻辑地址后，由硬件进行地址转换，将页号送入高速缓存寄存器，并将此页号与快表中的所有页号进行比较</li>
<li>若找到匹配的页号，说明所要访问的页表项在快表中，则直接从中取出该页对应的页框号，与页内偏移量拼接形成物理地址。这样，存取数据仅一次访存便可实现</li>
<li>若未找到匹配的页号，则需要访问主存中的页表，读出页表项后，应同时将其存入快表，以便后面可能的再次访问。若快表已满，则须按特定的算法淘汰一个旧页表项</li>
</ul>
</li>
<li>给定快表命中率a和快表访问时间b，慢表访问时间c，求平均耗时T<ul>
<li>先块表后慢表<ul>
<li>$T=(b+c)<em>a+(b+c+c)</em>(1-a)$</li>
</ul>
</li>
<li>块表慢表同时查询<ul>
<li>$T=(b+c)<em>a+(c+c)</em>(1-a)$</li>
</ul>
</li>
</ul>
</li>
<li>基于局部性原理</li>
<li>快表命中——一次访存；未命中——两次</li>
</ul>
<p><strong>两级页表</strong></p>
<ul>
<li><p>单级页表的问题</p>
<ul>
<li>页表必须连续存放，当页表很大时，需要占用很多个连续的页框</li>
<li>没有必要让整个页表常驻内存，因为进程在一段时间内只需要访问某几个特点的页面</li>
</ul>
</li>
<li><p>==顶级页表最多只能有一个页面==</p>
</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309041951525.png" alt="image-20230904195152347"></li>
<li>访存次数（假设没有快表）<ul>
<li>二级——三次</li>
<li>三级——四次</li>
<li>……</li>
</ul>
</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309041952608.png" alt="image-20230904195239664"></li>
</ul>
<h3 id="3-1-5基本分段存储管理方式"><a href="#3-1-5基本分段存储管理方式" class="headerlink" title="3.1.5基本分段存储管理方式"></a>3.1.5基本分段存储管理方式</h3><ul>
<li>从用户和程序员的角度考虑，以满足方便编程、信息保护和共享、动态增长及动态链接等多方面的需要</li>
<li>分配大的连续空间不方便，会产生外部碎片</li>
</ul>
<p><strong>分段</strong></p>
<ul>
<li>按照用户进程中的自然段划分逻辑空间</li>
<li>段内要求连续，段间无要求</li>
<li>二维（标识一个地址，既要给出段名，也要给出段内地址）<ul>
<li>段长不固定</li>
<li>分页——一维</li>
<li>二级分页——一维<ul>
<li>页长固定，给定一个整数能自己推算出偏移等</li>
</ul>
</li>
</ul>
</li>
<li>每段都从0开始编址</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309041958378.png" alt="image-20230904195812180"></li>
</ul>
<p><strong>段表</strong></p>
<ul>
<li>组成<ul>
<li>段号（隐藏）</li>
<li>段长（不固定）</li>
<li>本段在主存中的起始地址</li>
</ul>
</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309042000900.png" alt="image-20230904200058714"></li>
</ul>
<p><strong>地址变换机构</strong></p>
<ul>
<li>段表寄存器<ul>
<li>存放段表起始地址F和段表长度M</li>
</ul>
</li>
<li>过程<ul>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309042001366.png" alt="image-20230904200155470"></li>
<li>取出逻辑地址A的前几位为段号S，后几位为段内偏移量W</li>
<li>比较段号S和段表长度M，若<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.312ex;" xmlns="http://www.w3.org/2000/svg" width="6.854ex" height="1.907ex" role="img" focusable="false" viewBox="0 -705 3029.6 843"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mo" transform="translate(922.8,0)"><path data-c="2265" d="M83 616Q83 624 89 630T99 636Q107 636 253 568T543 431T687 361Q694 356 694 346T687 331Q685 329 395 192L107 56H101Q83 58 83 76Q83 77 83 79Q82 86 98 95Q117 105 248 167Q326 204 378 228L626 346L360 472Q291 505 200 548Q112 589 98 597T83 616ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path></g><g data-mml-node="mi" transform="translate(1978.6,0)"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g></g></g></svg></mjx-container>，则产生越界中断</li>
<li>段号S对应的段表项地址 = 段表始址F + 段号S * 段表项长度，取出该段表项的前几位得到段长C，若段内偏移量<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.312ex;" xmlns="http://www.w3.org/2000/svg" width="4.108ex" height="1.907ex" role="img" focusable="false" viewBox="0 -705 1815.8 843"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2265" d="M83 616Q83 624 89 630T99 636Q107 636 253 568T543 431T687 361Q694 356 694 346T687 331Q685 329 395 192L107 56H101Q83 58 83 76Q83 77 83 79Q82 86 98 95Q117 105 248 167Q326 204 378 228L626 346L360 472Q291 505 200 548Q112 589 98 597T83 616ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path></g><g data-mml-node="mi" transform="translate(1055.8,0)"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g></g></g></svg></mjx-container>，则产生越界中断</li>
<li>取出段表项中该段的始址b，计算物理地址<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="10.853ex" height="1.756ex" role="img" focusable="false" viewBox="0 -694 4797 776"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path></g><g data-mml-node="mo" transform="translate(1041.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(2097.6,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mo" transform="translate(2748.8,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(3749,0)"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></g></g></g></svg></mjx-container></li>
</ul>
</li>
</ul>
<p><strong>段的共享和保护</strong></p>
<ul>
<li>段的共享<ul>
<li>两个作业的段表中相应表项指向被共享的段的同一个物理副本</li>
</ul>
</li>
<li>纯代码/可重入代码<ul>
<li>不属于临界资源</li>
<li>不能被修改</li>
<li>可修改的代码和数据不能共享</li>
</ul>
</li>
<li>存取控制保护</li>
<li>地址越界保护<ul>
<li>比较段表寄存器中的段长与逻辑地址中的段号</li>
<li>比较段表项中的段长和逻辑地址中的段内偏移</li>
<li>分页管理只需判断页号是否越界</li>
</ul>
</li>
</ul>
<h3 id="3-1-6段页式管理方式"><a href="#3-1-6段页式管理方式" class="headerlink" title="3.1.6段页式管理方式"></a>3.1.6段页式管理方式</h3><ul>
<li><p>作业的逻辑地址</p>
<ul>
<li><p>段表项（定长）</p>
<ul>
<li><p>段号（隐藏）</p>
<ul>
<li>决定每个进程最多可以分为多少个段</li>
</ul>
</li>
<li><p>页号</p>
<ul>
<li>决定每个段最大有多少页</li>
</ul>
</li>
<li><p>页内偏移量</p>
<ul>
<li>决定页面大小</li>
</ul>
</li>
</ul>
</li>
<li><p><img src="https://gitee.com/renmale-sztu/image/raw/master/202309042023970.png" alt="image-20230904202356146"></p>
</li>
</ul>
</li>
<li><p>段表寄存器</p>
<ul>
<li>指出作业的段表始址和段表长度</li>
<li>段表寄存器和页表寄存器的作用都有两个<ul>
<li>在段表或页表中寻址</li>
<li>判断是否越界</li>
</ul>
</li>
</ul>
</li>
<li>在一个进程中，段表只有一个，而页表可能有多个</li>
<li>段页式管理的地址空间是二维的</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309042027016.png" alt="image-20230904202719134"><ul>
<li>三次访存</li>
<li>首先通过段表查询到页表始址</li>
<li>然后通过页表找到页帧号</li>
<li>最后形成物理地址</li>
</ul>
</li>
</ul>
<h2 id="3-2-虚拟内存管理"><a href="#3-2-虚拟内存管理" class="headerlink" title="3.2 虚拟内存管理"></a>3.2 虚拟内存管理</h2><h3 id="3-2-1虚拟内存的基本概念"><a href="#3-2-1虚拟内存的基本概念" class="headerlink" title="3.2.1虚拟内存的基本概念"></a>3.2.1虚拟内存的基本概念</h3><p><strong>传统存储管理方式的特征</strong></p>
<ul>
<li>一次性<ul>
<li>作业必须一次性全部装入内存，才能开始运行<ul>
<li>当作业量很大而不能全部装入内存时，将使该作业无法运行</li>
<li>当大量作业要求运行时，由于内存不足以容纳所有作业，只能使少数作业先运行，导致多道程序度的下降</li>
</ul>
</li>
</ul>
</li>
<li>驻留性<ul>
<li>作业被装入内存后，就一直驻留在内存中，其任何部分斗不会被换出，直至作业运行结束<ul>
<li>运行中的进程会因等待I/O而被阻塞，可能处于长期等待状态</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>局部性原理</strong></p>
<ul>
<li>时间局部性<ul>
<li>如果执行了程序中的某条指令，那么不久后这条指令很有可能再次执行；如果某个数据被访问过，不久之后该数据很可能再次被访问（因为程序中存在大量的循环）</li>
</ul>
</li>
<li>空间局部性<ul>
<li>一旦程序访问了某个存储单元，在不久之后，其附近的存储单元也很有可能被访问（因为很多数据在内存中都是连续存放的，并且程序的指令也是顺序地在内存中存放的）</li>
</ul>
</li>
<li>高速缓存技术<ul>
<li>依赖局部性原理<ul>
<li>快表</li>
<li>页高速缓存</li>
<li>虚拟内存</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>虚拟存储器的定义和特征</strong></p>
<ul>
<li>定义<ul>
<li>基于局部性原理，在程序装入时，可以将程序中很快会用到的部分装入内存，暂时用不到的部分留在外存，就可以让程序开始执行。在程序执行过程中，当所访问的信息不在内存时，由操作系统负责将所需信息从外存调入内存，然后继续执行程序。若内存空间不够，由操作系统负责将内存中暂时用不到的信息换出到外存。在操作系统的管理下，在用户看来似乎有一个比实际内存大得多的内存，这就是虚拟内存</li>
</ul>
</li>
<li>特征<ul>
<li>多次性<ul>
<li>无须在作业运行时一次性地全部装入内存，而允许被分成多次调入内存运行，即只需将当前要运行地那部分程序和数据装入内存即可开始运行</li>
<li>多次性是虚拟存储器最重要的特征</li>
</ul>
</li>
<li>对换性<ul>
<li>无须在作业运行时一直常驻内存，在进程运行期间，允许将那些暂不使用的程序和数据从内存调至外存的对换区（换出），待以后需要时再将它们从外存调至内存（换入）</li>
</ul>
</li>
<li>虚拟性<ul>
<li>从逻辑上扩充内存的容量，使用户所看到的内存容量远大于实际的内存容量</li>
<li>虚拟存储器所表现出的最重要特征</li>
<li>实现虚拟存储器的最重要目标</li>
</ul>
</li>
</ul>
</li>
<li>容量<ul>
<li>最大容量<ul>
<li>有计算机的地址结构（CPU寻址范围）确定</li>
</ul>
</li>
<li>实际容量<ul>
<li>min(内存和外存容量之和，CPU寻址范围)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>虚拟内存技术的实现</strong></p>
<ul>
<li><p>建立在离散分配的内存管理方式的基础上</p>
</li>
<li><p>三种方式</p>
<ul>
<li>请求分页存储管理</li>
<li>请求分段存储管理</li>
<li>请求段页式存储管理</li>
</ul>
</li>
<li><p>虚拟内存的容量要满足两个条件</p>
<ul>
<li>虚存的实际容量 ≤ 内存容量和外存容量之和</li>
<li>虚存的最大容量 ≤ 计算机的地址位数能容纳的最大容量</li>
</ul>
</li>
</ul>
<h3 id="3-2-2-请求分页管理方式"><a href="#3-2-2-请求分页管理方式" class="headerlink" title="3.2.2 请求分页管理方式"></a>3.2.2 请求分页管理方式</h3><p><strong>页表机制</strong></p>
<ul>
<li>新增字段<ul>
<li>状态位P<ul>
<li>用户指示该页是否已调入内存</li>
<li>供程序访问时参考</li>
</ul>
</li>
<li>访问字段A<ul>
<li>用于记录本页在一段时间内被访问的次数或本页最近已有多长时间未被访问</li>
<li>供置换算法换出页面时参考</li>
</ul>
</li>
<li>修改位M<ul>
<li>标识该页在调入内存后是否被修改过，以确定页面置换时是否写回内存</li>
</ul>
</li>
<li>外存地址<ul>
<li>用于指出该页在外存上的地址，通常是物理块号，供调入该页时参考</li>
</ul>
</li>
</ul>
</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309051537126.png" alt="image-20230905153735003"></li>
</ul>
<p><strong>缺页中断机构</strong></p>
<ul>
<li>在指令执行期间而非一条指令执行完后产生和处理中断信号，属于内部中断（内中断）</li>
<li>一条指令在执行期间，可能产生多次缺页中断</li>
</ul>
<p><strong>地址变换机构</strong></p>
<ul>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309051541445.png" alt="image-20230905154122573"><ul>
<li>先检查快表</li>
<li>若找到要访问的页，则修改页表项中的访问位（写指令还需要重置修改位），然后利用页表项中给出的物理块号和页内地址形成物理地址</li>
<li>若未找到该页的页表项，则应到内存中去查找页表，再对比页表项中的状态位P，看该页是否已调入内存，若页面已调入，则将该页的页表写入快表，若快表已满，则需采用某种算法替换。若页面未调入，则产生缺页中断，请求从外存把该页调入内存</li>
</ul>
</li>
<li>只有“写指令”才需要修改“修改位”。并且，一般来说只需修改快表中的数据，只有要将快表项删除时才需要写回内存中的慢表。这样可以减少访存次数。</li>
<li>和普通的中断处理一样，缺页中断处理依然需要保留CPU现场</li>
<li>需要用某种“页面置换算法”来决定一个换出页面</li>
<li>换入/换出页面都需要启动慢速的I/O操作，可见，如果换入/换出太频繁，会有很大的开销。</li>
<li>页面调入内存后，需要修改慢表，同时也需要将表项复制到快表中。</li>
</ul>
<h3 id="3-2-3页框分配"><a href="#3-2-3页框分配" class="headerlink" title="3.2.3页框分配"></a>3.2.3页框分配</h3><p><strong>驻留集大小</strong></p>
<ul>
<li>给一个进程分配的物理页框的集合就是这个进程的驻留集</li>
<li>分配给一个进程的页框越少，驻留在主存中的进程就越多，从而可提高CPU的利用率</li>
<li>若一个进程在主存中的页面过少，则尽管有局部性原理，缺页率仍相对较高</li>
<li>若分配的页框过多，则由于局部性原理，对该进程的缺页率没有太明显的影响</li>
</ul>
<p><strong>内存分配策略</strong></p>
<ul>
<li><p>概念</p>
<ul>
<li>固定分配<ul>
<li>操作系统为每个进程分配一组固定数目的物理块，在进程运行期间不再改变。即，驻留集大小不变</li>
</ul>
</li>
<li>可变分配<ul>
<li>先为每个进程分配一定数目的物理块，在进程运行期间，可根据情况做适当的增加或减少。即，驻留集大小可变</li>
</ul>
</li>
<li>局部置换<ul>
<li>发生缺页时只能选进程自己的物理块进行置换</li>
</ul>
</li>
<li>全局置换<ul>
<li>可以将操作系统保留的空闲物理块分配给缺页进程，也可以将别的进程持有的物理块置换到外存，再分配给缺页进程</li>
</ul>
</li>
</ul>
</li>
<li><p>策略</p>
<ul>
<li><p>固定分配局部置换</p>
<ul>
<li>系统为每个进程分配一定数量的物理块，在整个运行期间都不改变。若进程在运行中发生缺页，则只能从该进程在内存中的页面中选出一页换出，然后再调入需要的页面</li>
<li>这种策略的缺点是：很难在刚开始就确定应为每个进程分配多少个物理块才算合理。<ul>
<li>太少会频繁出现缺页中断，太多又会降低CPU和其他资源的利用率</li>
</ul>
</li>
</ul>
</li>
<li><p>可变分配全局置换</p>
<ul>
<li>刚开始会为每个进程分配一定数量的物理块。操作系统会保持一个空闲物理块队列。当某进程发生缺页时，从空闲物理块中取出一块分配给该进程；若已无空闲物理块，则可选择一个未锁定（锁定的页面不能换出外存）的页面换出外存，再将该物理块分配给缺页的进程。采用这种策略时，只要某进程发生缺页，都将获得新的物理块，仅当空闲物理块用完时，系统才选择一个未锁定的页面调出。被选择调出的页可能是系统中任何一个进程中的页，因此这个被选中的进程拥有的物理块会减少，缺页率会增加。</li>
<li>盲目地给进程增加物理块，从而导致系统多道程序的并发能力下降</li>
</ul>
</li>
<li><p>可变分配局部置换</p>
<ul>
<li>刚开始会为每个进程分配一定数量的物理块。当某进程发生缺页时，只允许从该进程自己的物理块中选出一个进行换出外存。如果进程在运行中频繁地缺页，系统会为该进程多分配几个物理块，直至该进程缺页率趋势适当程度；反之，如果进程在运行中缺页率特别低，则可适当减少分配给该进程的物理块。</li>
<li>这种方法在保证进程不会过多地调页的同时，也保持了系统的多道程序并发能力。当然它需要更复杂的实现，也需要更大的开销，但对比频繁地换入/换出所浪费的计算机资源，这种牺牲是值得的</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>物理块调入算法</strong></p>
<ul>
<li>固定分配分配算法<ul>
<li>平均分配算法<ul>
<li>将系统中所有可供分配的物理块平均分配给各个进程</li>
</ul>
</li>
<li>按比例分配算法<ul>
<li>根据进程的大小按比例分配物理块</li>
</ul>
</li>
<li>优先权分配算法<ul>
<li>为重要和紧迫的进程分配较多的物理块</li>
<li>通常采取把所有可分配的物理块分成两部分，一部分按比例，一部分按优先权</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>调入页面的时机</strong></p>
<ul>
<li>预调页策略（运行前调入）<ul>
<li>主要用户进程的首次调入</li>
</ul>
</li>
<li>请求调页策略<ul>
<li>在运行期间发现缺页时才将所缺页面调入内存</li>
</ul>
</li>
</ul>
<p><strong>从何处调入页面</strong></p>
<ul>
<li>外存分为两部分<ul>
<li>用于存放文件的文件区：通常采用离散分配方式</li>
<li>用于存放对换页面的对换区：通常采用连续分配方式</li>
</ul>
</li>
<li>三种情况<ul>
<li>系统拥有足够的对换区空间<ul>
<li>可以全部从对换区调入所需页面，以提高调页速度。为此在进程运行前，需将与该进程有关的文件从文件区复制到对换区</li>
</ul>
</li>
<li>系统缺少足够的对换区空间<ul>
<li>凡是不会被修改的文件都直接从文件区调入；而当换出这些页面时，由于它们未被修改而不必再将它们换出。但对于那些可能被修改的部分，在将它们换出时须调到对换区，以后需要时再从对换区调入（因为读比写的速度快）</li>
</ul>
</li>
<li>UNIX方式<ul>
<li>与进程有关的文件都放在文件区，因此未运行过的页面都应从文件区调入曾经运行过但又被换出的页面，由于是放在对换区，因此在下次调入时应从对换区调入进程请求的共享页面若被其他进程调入内存，则无须再从对换区调入</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>如何调入页面</strong></p>
<ol>
<li>缺页</li>
<li>缺页中断</li>
<li>缺页中断处理程序</li>
<li>…….</li>
</ol>
<h3 id="3-2-4页面置换算法"><a href="#3-2-4页面置换算法" class="headerlink" title="3.2.4页面置换算法"></a>3.2.4页面置换算法</h3><p><strong>最佳（OPT）置换算法</strong></p>
<ul>
<li>每次选择的页面是以后永不使用的页面，或者最长时间内不再被访问的页面，以确保最低的缺页率</li>
<li>该算法无法实现</li>
</ul>
<p><strong>先进先出（FIFO）算法</strong></p>
<ul>
<li><p>优先淘汰最早进入内存的页面，即淘汰在内存中驻留最久的页面</p>
</li>
<li><p>Belady异常</p>
<ul>
<li>当为进程分配的物理块数增大时，缺页次数不减反增的异常现象</li>
<li>只有FIFO算法会产生Belady异常</li>
</ul>
</li>
<li>实现简单，算法性能差</li>
</ul>
<p><strong>最近最久未使用（LRU）算法</strong></p>
<ul>
<li>每次选择最近最长时间未访问过的页面淘汰，该算法未每个页面设置一个访问字段，用来记录页面上一次被访问以来所经历的时间，淘汰页面时选择现有页面中值最大的淘汰</li>
<li>性能好，当需要寄存器和栈的硬件支持，开销大</li>
</ul>
<p><strong>时钟（CLOCK）置换算法</strong></p>
<ul>
<li><p>简单的CLOCK置换算法</p>
<ul>
<li>为每帧设置一位访问位，当某页首次被装入或被访问时，其访问位被置为1</li>
<li>将内存中的所有页面视为一个循环队列，并有一个替换指针与之相关联，当某一页被替换时，该指针被设置指向被替换页面的下一页。在选择一页淘汰时，只需检查页的访问位。若为0，就选择该页换出：若为1，则将它置为0，暂不换出，给予该页第二次驻留内存的机会，再依次顺序检查下一个页面。当检查到队列中的最后一个页面时，若其访问位仍为1，则返回到队首去循环检查</li>
<li>该算法是循环地检查各个页面的使用情况，故称CLOCK算法但是，因为该算法只有一位访问位，而置换时将未使用过的页面换出，故又称最近未用(N RU）算法</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309051710784.png" alt="image-20230905171026827"></li>
</ul>
</li>
<li><p>改进型CLOCK置换算法</p>
<ul>
<li>将一个页面换出时，若该页已被修改过，则要将该页写回磁盘，若该页未被修改过，则不必将它写回磁盘。可见，对于修改过的页面，替换代价更大。在改进型CLOCK算法中，除考虑页面使用情况外，还增加了置换代价——修改位</li>
<li></li>
<li>访问位A和修改位M<ul>
<li>A=0,M=0；最近未被访问且未被修改，是最佳淘汰页</li>
<li>A=0，M=1；最近未被访问，但已被修改，不是很好的淘汰页</li>
<li>A=1.M=0:最近已被访问，但未被修改，可能再被访问</li>
<li>A=1,M=1:最近已被访问且已被修改，可能再被访问</li>
</ul>
</li>
<li>过程<ol>
<li>从指针的当前位置开始，扫描循环队列，寻找A=0且M=0的1类页面，将遇到的第一个1类页面作为选中的淘汰页。在第一次扫描期间不改变访问位A</li>
<li>若第1）步失败，则进行第二轮扫描，寻找A=0且M=1的2类页面。将遇到的第一个2类页面作为淘汰页。在第二轮扫描期间，将所有扫描过的页面的访问位都置0</li>
<li>若第2）步也失败，则将指针返回到开始的位置，并将所有帧的访问位复0。重复第1）步，并且若有必要，重复第2）步，此时一定能找到被淘汰的页</li>
</ol>
</li>
<li>最多进行4轮循环</li>
<li>改进型CLOCK算法优于简单CLOCK算法的地方在于，可减少磁盘的I/O操作次数。但为了找到一个可置换的页，可能要经过几轮扫描，即实现算法本身的开销将有所增加</li>
</ul>
</li>
</ul>
<h3 id="3-2-5抖动和工作集"><a href="#3-2-5抖动和工作集" class="headerlink" title="3.2.5抖动和工作集"></a>3.2.5抖动和工作集</h3><p><strong>抖动（颠簸）</strong></p>
<ul>
<li>发生的原因：某个进程频繁访问的页面数目高于可用的物理页帧数目</li>
</ul>
<p><strong>工作集</strong></p>
<ul>
<li>某段时间间隔内，进程要访问的页面集合</li>
<li>驻留集大小不能小于工作集大小</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309051930871.png" alt="image-20230905193013779"></li>
</ul>
<h3 id="3-2-6内存映射文件"><a href="#3-2-6内存映射文件" class="headerlink" title="3.2.6内存映射文件"></a>3.2.6内存映射文件</h3><ul>
<li>将磁盘文件的全部或部分内容与进程虚拟地址空间的某个区域建立映射关系，便可以直接访问被映射的文件，而不必执行文件I/O操作，也无须对文件内容进行缓存处理</li>
<li>使用内存映射文件所进行的任何实际交互都是在内存中进行的，并且是以标准的内存地址形式来访问的</li>
<li>系统内存中的所有页面都由虚拟存储器负责管理，虚拟存储器以统一的方式处理所有磁盘I/O.当进程退出或显式地解除文件映射时，所有被改动的页面会被写回磁盘文件。</li>
<li>多个进程允许并发地内存映射同一文件，以便允许数据共享，共享内存是通过内存映射来实现的</li>
</ul>
<h3 id="3-2-7虚拟存储器性能影响因素"><a href="#3-2-7虚拟存储器性能影响因素" class="headerlink" title="3.2.7虚拟存储器性能影响因素"></a>3.2.7虚拟存储器性能影响因素</h3><ul>
<li>缺页率（缺页率高即为抖动）是影响虚拟存储器性能的主要因素<ul>
<li>页面大小<ul>
<li>根据局部性原理，页面较大则缺页率较低，页面较小则缺页率较高。页面较小时，一方面减少了内存碎片，有利于提高内存利用率；另一方面，也会使每个进程要求较多的页面，导致页表过长，占用大量内存。页面较大时，虽然可以减少页表长度，但会使页内碎片增大</li>
</ul>
</li>
<li>工作集<ul>
<li>分配给进程的物理块数越多，缺页率就越低，但是当物理块超过某个数目时，再为进程增加一个物理块对缺页率的改善是不明显的</li>
</ul>
</li>
<li>页面置换算法<ul>
<li>好的页面置换算法可使进程在运行过程中具有较低的缺页率</li>
</ul>
</li>
<li>程序的编制方法<ul>
<li>编写程序的局部化程度越高，执行时的缺页率就越低。如果存储采用的是按行存储，访问时就要尽量采用相同的访问方式，避免按列访问造成缺页率过高的现象</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="3-2-8-地址翻译"><a href="#3-2-8-地址翻译" class="headerlink" title="3.2.8 地址翻译"></a>3.2.8 地址翻译</h3><ul>
<li>计算机组成原理结合</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/09/05/%E7%AC%AC%E4%BA%8C%E7%AB%A0%20%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="renmale-lv">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="renmale-lv blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | renmale-lv blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/09/05/%E7%AC%AC%E4%BA%8C%E7%AB%A0%20%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B/" class="post-title-link" itemprop="url">第二章 进程和线程</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2023-09-05 12:27:13 / Modified: 21:02:22" itemprop="dateCreated datePublished" datetime="2023-09-05T12:27:13+08:00">2023-09-05</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>15k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>14 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <meta name="referrer" content="no-referrer">

<h2 id="2-1进程和线程"><a href="#2-1进程和线程" class="headerlink" title="2.1进程和线程"></a>2.1进程和线程</h2><h3 id="进程的概念和特征"><a href="#进程的概念和特征" class="headerlink" title="进程的概念和特征"></a>进程的概念和特征</h3><ul>
<li>概念<ul>
<li>进程是程序的一次执行过程</li>
<li>进程是一个程序及其数据在处理机上顺序执行时所发生的活动</li>
<li>进程时具有独立功能的程序在一个数据集合上运行的过程，它是系统进行资源分配和调度的一个独立单位</li>
</ul>
</li>
<li><p>特征</p>
<ul>
<li>动态性<ul>
<li>动态性是进程最基本的特征</li>
</ul>
</li>
<li>并发性<ul>
<li>并发性事进程的重要特征，也是操作系统的重要特征</li>
</ul>
</li>
<li>独立性<ul>
<li>进程实体是一个能独立运行、独立获得资源和独立接受调度的基本单位</li>
</ul>
</li>
<li>异步性<ul>
<li>各并发的进程以各自独立的、不可预知的速度向前推进<h3 id="进程的状态与转换"><a href="#进程的状态与转换" class="headerlink" title="进程的状态与转换"></a>进程的状态与转换</h3></li>
</ul>
</li>
</ul>
</li>
<li><p>5种状态</p>
<ul>
<li>运行态</li>
<li>就绪态</li>
<li>阻塞态</li>
<li>创建态</li>
<li>结束态</li>
</ul>
</li>
<li><p>前3种是基本状态</p>
</li>
<li>状态的转换<ul>
<li>就绪态→运行态</li>
<li>运行态→就绪态</li>
<li>运行态→阻塞态</li>
<li>阻塞态→就绪态</li>
<li><img src="https://th.bing.com/th/id/Rac88fec7ff0914ae100f5e5e16e8dcfe?rik=7YelQuouaD%2bGjA&amp;riu=http%3a%2f%2fbbs.yanzhishi.cn%2fimage%2fshow%2fattachments-2020-06-xiLvreQp5eddd748e949a.jpg&amp;ehk=ltevwD1oUrnv7VDTg627MgfwonKq5e28Z%2bNCcgsA8E8%3d&amp;risl=&amp;pid=ImgRaw" alt=""></li>
<li>一个进程从运行态变成阻塞态是主动行为</li>
<li>从阻塞态变成就绪态是被动行为，需要其他相关进程的协助</li>
</ul>
</li>
<li>进程的组织方式<ul>
<li>链接方式<ul>
<li>按照进程状态将PCB分为多个队列</li>
<li>操作系统持有指向各个队列的指针</li>
</ul>
</li>
<li>索引方式<ul>
<li>根据进程状态的不同，建立几张索引表</li>
<li>操作系统持有指向各个索引表的指针</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="进程的组成"><a href="#进程的组成" class="headerlink" title="进程的组成"></a>进程的组成</h3><ul>
<li>进程控制块（PCB）<ul>
<li>系统利用PCB来描述进场的基本情况和运行状态，进而控制和管理进程</li>
<li>PCB是进程存在的唯一标志</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202308262144282.png" alt="image-20230826214434112"></li>
</ul>
</li>
<li>相关数据段<ul>
<li>可以是进程对应的程序加工处理的原始数据，也可以是程序执行时产生的中间或最终结果</li>
</ul>
</li>
<li>程序段<ul>
<li>能被进程调度程序调度到CPU执行的程序代码段</li>
</ul>
</li>
</ul>
<h3 id="进程控制"><a href="#进程控制" class="headerlink" title="进程控制"></a>进程控制</h3><ul>
<li>概念<ul>
<li>进程控制的主要功能是对系统中的所有进程实施有效的管理，它具有创建新进程、撤销已有进程、实现进程状态转换等功能</li>
</ul>
</li>
<li><p>原语</p>
<ul>
<li>一般把进程控制用的程序称为原语</li>
<li>执行期间不允许中断</li>
<li>不可分割的基本单位</li>
<li>开中断/关中断</li>
</ul>
</li>
<li><p>进程的创建：创建原语</p>
<ul>
<li>过程<ul>
<li>为新进程分配一个唯一的进程标识号，并申请一个空白PCB</li>
<li>为进程分配其运行所需的资源</li>
<li>初始化PCB</li>
<li>将新进程插入就绪队列</li>
</ul>
</li>
<li>引起进程创建的事件<ul>
<li>用户登陆</li>
<li>作业调度</li>
<li>提供服务</li>
<li>应用请求</li>
</ul>
</li>
</ul>
</li>
<li>进程的终止：撤销原语<ul>
<li>过程<ul>
<li>从PCB集合中超导终止终止进程的PCB</li>
<li>若进程正在运行，立即剥夺CPU，将CPU分配给其他进程</li>
<li>终止其所有子进程</li>
<li>将该进程拥有的所有资源归还给父进程或操作系统</li>
<li>删除PCB</li>
</ul>
</li>
<li>引起进程终止的事件主要 <ul>
<li>正常结束</li>
<li>异常结束</li>
<li>外界干预</li>
</ul>
</li>
</ul>
</li>
<li>进程的阻塞和唤醒：阻塞原语（Block）、唤醒原语（Wakeup）<ul>
<li>阻塞原语<ul>
<li>过程<ul>
<li>找到要阻塞的进程对应的PCB</li>
<li>保护进程运行现场，将PCB状态信息设置为“阻塞态“，暂时停止进程运行</li>
<li>将PCB插入相应事件的等待队列</li>
</ul>
</li>
<li>引起事件<ul>
<li>需要等待系统分配某种资源</li>
<li>需要等待相互合作的其他进程完成工作</li>
</ul>
</li>
</ul>
</li>
<li>唤醒原语<ul>
<li>过程<ul>
<li>在事件等待中找到PCB</li>
<li>将PCB从等待队列移除，设置进程为就绪态</li>
<li>将PCB插入就绪队列，等待被调度</li>
</ul>
</li>
<li>引起事件<ul>
<li>等待的事件发生</li>
</ul>
</li>
</ul>
</li>
<li>阻塞原语和唤醒原语作用相反，必须成对使用</li>
</ul>
</li>
<li>进程切换：切换原语<ul>
<li>引起事件<ul>
<li>当前进程时间片到</li>
<li>有更高优先级的进程到达</li>
<li>当前进程主动阻塞</li>
<li>当前进程终止</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="进程的通信"><a href="#进程的通信" class="headerlink" title="进程的通信"></a>进程的通信</h3><ul>
<li>低级通信方式―PV操作</li>
<li>高级通信方法 ↓ <ul>
<li>共享存储<ul>
<li>在通信的进程之间存在一块可直接访问的共享空间，通过对共享空间进行写/读操作实现进程之间的信息交换</li>
<li>在对共享空间进行读/写操作时，需要使用同步互斥工具</li>
<li>分类<ul>
<li>基于数据结构的共享——低级</li>
<li>基于存储区的共享——高级</li>
</ul>
</li>
<li>操作系统只负责为通信进程提供可共享使用的存储空间和同步互斥工具，数据交换由用户自己安排读/写指令</li>
</ul>
</li>
<li>消息传递：<ul>
<li>在消息传递系统中，进程间的数据交换以格式化的消息为单位</li>
<li>通过操作系统提供的发送消息和接受消息两个原语来进行数据交换</li>
<li>微内核与服务器之间的通信就采用了消息传递</li>
<li>分类<ul>
<li>直接通信方式<ul>
<li>发送进程直接把消息发送给接收进程</li>
</ul>
</li>
<li>间接通信方式<ul>
<li>发送进程把消息发送到某个中间实体，接收进程从中间实体取得消息</li>
<li>中间实体一般称为信箱</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>管道通信―是消息传递的一种特殊方式<ul>
<li>pipe文件</li>
<li>允许进程按生产者-消费者方式进行通信</li>
<li>数据在管道中先进先出</li>
<li>克服文件进行通信<ul>
<li>限制管道大小</li>
<li>读进程也可能工作得比写进程快</li>
</ul>
</li>
<li>从管道读数据时一次性操作，数据一旦被读取，就被管道抛弃<ul>
<li>一个管道允许多个写进程，一个读进程（2014年408真题高教社官方答案）</li>
<li>多个写进程，多个读进程（Linux）</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="线程概念和多线程模型"><a href="#线程概念和多线程模型" class="headerlink" title="线程概念和多线程模型"></a>线程概念和多线程模型</h3><p><strong>线程的基本概念</strong></p>
<ul>
<li><p>概念</p>
<ul>
<li>线程最直接的理解就是“轻量级进程”，他是一个基本的CPU执行单元</li>
</ul>
</li>
<li><p>组成</p>
<ul>
<li>线程ID</li>
<li>程序计数器</li>
<li>寄存器集合</li>
<li>堆栈</li>
</ul>
</li>
<li>进程与线程的比较<ul>
<li>调度<ul>
<li>线程是独立调度的基本单位，进程是拥有资源的基本单位</li>
<li>同一进程的线程切换不会引起进程切换</li>
<li>不同进程的线程切换会引起进程切换</li>
</ul>
</li>
<li>拥有资源<ul>
<li>进程是拥有资源的基本单位，而线程不拥有系统资源（除了一点点必不可少的资源）</li>
</ul>
</li>
<li>并发性<ul>
<li>一个进程中的多个线程之间可以并发执行，甚至不同进程中的线程也能并发执行</li>
<li>提高了系统资源的利用率和系统的吞吐量</li>
</ul>
</li>
<li>独立性<ul>
<li>每个进程都拥有独立的地址空间和资源，除了共享全局变量，不允许其他进程访问</li>
<li>某进程中的线程对其他进程不可见</li>
<li>同一进程的线程共享进程的地址空间和资源</li>
</ul>
</li>
<li>系统开销<ul>
<li>线程的创建和切换易于进程</li>
<li>线程之间的同步与通信非常容易实现，无须操作系统的干预</li>
<li>进程间通信（IPC）需要进程同步和互斥手段的辅助，以保证数据的一致性</li>
</ul>
</li>
<li>支持多处理机系统<ul>
<li>各个线程可以占用不同的CPU</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>线程的属性</strong> </p>
<ul>
<li>线程是一个轻型实体，它不拥有系统资源，但每个线程都应有一个唯一的标识符和一个线程控制块，线程控制块记录线程执行的寄存器和栈等现场状态</li>
<li>不同线程可以执行相同的程序，即同一个服务程序被不同的用户调用时，操作系统把它们创建成不同的线程</li>
<li>同一进程的各个线程共享该进程所拥有的资源</li>
<li>线程是处理机的独立调度单位，多个线程是可以并发执行的；在多CPU的计算机系统中，各线程可同时占用不同的CPU</li>
<li>一个线程被创建后，便开始了它的生命周期，直至终止。线程在生命周期内会经历阻塞态、就绪态和运行态等各种状态变化、</li>
</ul>
<p><strong>线程的状态和转移</strong></p>
<ul>
<li>执行状态：线程已获得处理机而正在运行</li>
<li>就绪状态：线程已具备各种执行条件，只需再获得CPU便可立即执行</li>
<li>阻塞状态：线程在执行中因某事件受阻而处于暂停状态</li>
<li>线程着三种基本状态之间的转换和进程基本状态之间的转换是一样的</li>
</ul>
<p><strong>线程的组织和控制</strong></p>
<ul>
<li>线程控制块TCB<ul>
<li>线程标识符，TID（与PID类似）</li>
<li>一组寄存器，包括程序计数器，状态寄存器和通用寄存器</li>
<li>线程运行状态，用于描述线程正处于何种状态</li>
<li>优先级</li>
<li>线程专有存储区，线程切换时用于保存现场</li>
<li>堆栈指针，由于过程调用时保存局部变量和返回地址</li>
</ul>
</li>
<li>同一进程中的所有线程都完全共享进程的地址空间和全局变量，一个线程可以读、写、甚至清楚另一个线程的堆栈、</li>
<li>”初始化线程“——用于创建新线程</li>
<li>通常，线程被终止后并不立即释放它所占有的资源，只有当进程中的其他线程执行了分离函数后，被终止线程才与资源分离，此时的资源才能被其他线程利用</li>
<li>被终止但尚未释放资源的线程仍可被其他线程调用，以使被终止线程重新恢复运行</li>
</ul>
<p><strong>线程的实现方式</strong></p>
<ul>
<li>用户级线程 ULT<ul>
<li>有关线程管理（创建、撤销和切换等）的所有工作都由应用程序在用户空间（应用程序）中完成，内核意识不到线程的存在</li>
<li>优点：<ul>
<li>进程切换不需要转换到内核空间，节省了模式切换的开销</li>
<li>调度算法可以是进程专用的，不同的进程可根据自身的需要，对自己的线程选择不同的调度算法</li>
<li>用户及线程的实现和操作系统平台无关，对线程管理的代码时属于用户程序的一部分</li>
</ul>
</li>
<li>缺点<ul>
<li>系统调用的阻塞问题，当线程执行一个系统调用时，不仅该线程会被阻塞，而且进程内的所有线程都会被阻塞</li>
<li>不能发挥多处理机的优势，内核每次分配给一个进程的仅有一个CPU，因此进程中仅有一个线程能执行</li>
</ul>
</li>
</ul>
</li>
<li>内核级线程 KLT（内核支持的线程）<ul>
<li>线程管理的所有工作由操作系统内核完成</li>
<li>优点<ul>
<li>能发挥多处理机的优势，内核能同时调度同一进程中的多个线程并行执行</li>
<li>如果进程中的一个线程被阻塞，内核可以调度该进程中的其他线程占用处理机，也可以运行其他进程中的线程</li>
<li>内核支持线程具有很小的数据结构和堆栈，线程切换比较快、开销小</li>
<li>内核本身与可采用多线程技术，可以提高系统的执行速度和效率</li>
</ul>
</li>
<li>缺点<ul>
<li>同一进程中的线程切换，需要从用户态转到核心态进行，系统开销较大，这是因为用户进程的线程在用户态运行，而线程调度和管理是在内核实现的</li>
</ul>
</li>
</ul>
</li>
<li>组合方式<ul>
<li>结合上述两种方式</li>
</ul>
</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202308301513927.png" alt="image-20230830151304967"></li>
</ul>
<p><strong>多线程模型</strong></p>
<ul>
<li>有些系统同时支持用户线程和内核线程，由此产生了不同的多线程模型  </li>
<li>多对一模型<ul>
<li>将多个用户级线程映射到一个内核级线程</li>
<li>优点——线程管理是在用户空间进行的，因而效率比较高</li>
<li>缺点——如果一个线程在访问内核时发送阻塞，则整个进程都会被阻塞；在任何时刻，只有一个线程能够访问内核，多个线程不能同时在多个处理机上运行</li>
</ul>
</li>
<li>一对一模型<ul>
<li>将每个用户及线程映射到一个内核级线程</li>
<li>优点——当一个线程被阻塞后，允许调度另一个线程运行，所以并发能力较强</li>
<li>缺点——没创建一个用户线程，相应地就需要创建以一个内核线程，开销较大</li>
</ul>
</li>
<li>多对多模型<ul>
<li>将N个用户及线程映射到M个内核级线程上（N ≥ M）</li>
<li>既克服了多对一模型并发度不高的缺点，又克服了一对一模型的一个用户进程占用太多内核级线程而开销太大的缺点；此外，还拥有上述两种模型各自的优点</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202308301518606.png" alt="image-20230830151836929"></li>
</ul>
</li>
</ul>
<h2 id="2-2-处理机的调度"><a href="#2-2-处理机的调度" class="headerlink" title="2.2 处理机的调度"></a>2.2 处理机的调度</h2><h3 id="调度的概念"><a href="#调度的概念" class="headerlink" title="调度的概念"></a>调度的概念</h3><ul>
<li>调度的基本概念<ul>
<li>处理机调度是对处理机进行分配，即从就绪队列按照一定的算法（公平、高效）选择一个进程并将处理机分配给他运行，以实现进程并发地执行</li>
<li>处理机调度是多道程序操作系统的基础，是操作系统设计的核心问题</li>
</ul>
</li>
<li>调度层次<ul>
<li>作业调度/高级调度<ul>
<li>按照某种规则，从后备队列中选择合适的作业将其调入内存，并为其创建进程</li>
<li>每个作业只调入一次，调出一次</li>
<li>内存与辅存之间的调度</li>
<li>多道批处理系统大多配有作业调度，而其他系统中通常不需要配置作业调度</li>
<li>外存→内存（面向作业）</li>
</ul>
</li>
<li>中继调度/内存调度<ul>
<li>按照某种规则，从挂起队列中选择合适的进程将其数据调回内存</li>
<li>作用：提高内存利用率和系统吞吐量</li>
<li>为此将哪些暂时不能运行的进程调至外存等待，把此时的进程状态称为<strong>挂起态</strong> ，当它们已具备运行条件且内存稍有空闲时，则重新调入内存，并修改其状态为就绪态，挂在就绪队列上等待</li>
<li>外存→内存（面向进程）</li>
</ul>
</li>
<li>进程调度/低级调度<ul>
<li>按照某种规则，从就绪队列中选择一个进程为其分配处理机</li>
<li>是操作系统中最基本的一种调度，进程调度的频率很高，一般十几毫秒一次</li>
<li>内存→CPU</li>
</ul>
</li>
</ul>
</li>
<li>三级调度的联系<ul>
<li>作业调度为进程活动做准备，进程调度使进程正常活动起来</li>
<li>中级调度将暂时不能运行的进程挂起，中级调度处于作业调度和进程调度之间</li>
<li>作业调度次数少，中级调度次数略多，进程调度频率最高</li>
<li>进程调度是最基本的，不可或缺</li>
</ul>
</li>
</ul>
<h3 id="调度的目标"><a href="#调度的目标" class="headerlink" title="调度的目标"></a>调度的目标</h3><ul>
<li>CPU利用率<ul>
<li>利用率 = CPU有效工作时间 / ( CPU有效工作时间 + CPU空闲等待时间)</li>
</ul>
</li>
<li>系统吞吐量<ul>
<li>单位时间内CPU完成作业的数量</li>
</ul>
</li>
<li>周转时间<ul>
<li>作业提交到完成所经历的时间</li>
<li>周转时间 = 作业完成时间 - 作业提交时间</li>
<li>平均周转时间 = （作业1周转时间 + … + 作业n周转时间）/ n</li>
<li>带权周转时间 = 作业周转时间  / 作业实际运行时间</li>
<li>平均带权周转时间 = （作业1带权周转时间 + … + 作业n带权周转时间）/ n</li>
</ul>
</li>
<li>等待时间<ul>
<li>进程处于等处理机的时间之和</li>
</ul>
</li>
<li>响应时间<ul>
<li>用户提交请求到系统首次产生响应所用的时间</li>
</ul>
</li>
</ul>
<h3 id="调度的实现"><a href="#调度的实现" class="headerlink" title="调度的实现"></a>调度的实现</h3><p><strong>调度程序（调度器）</strong></p>
<ul>
<li><p>用于调度和分派CPU的组件</p>
</li>
<li><p><img src="https://gitee.com/renmale-sztu/image/raw/master/202308301807183.png" alt="image-20230830173250356"></p>
</li>
<li>组成<ul>
<li>排队器<ul>
<li>将进程插入到相应的就绪队列中</li>
</ul>
</li>
<li>分派器<ul>
<li>将CPU分配给新进程</li>
</ul>
</li>
<li>上下文切换器<ul>
<li>将当前进程的上下文保存到其PCB中，再装入分派程序的上下文</li>
<li>移出分派程序的上下文，将新选进程的CPU现场信息装入处理机的各个相应寄存器</li>
</ul>
</li>
</ul>
</li>
<li>调度时机<ul>
<li>创建新进程</li>
<li>进程退出</li>
<li>运行进程阻塞</li>
<li>I/O中断发生</li>
</ul>
</li>
</ul>
<p><strong>调度的时机、切换与过程</strong></p>
<ul>
<li>不能进行进程的调度与切换的情况<ul>
<li>在处理中断的过程中</li>
<li>进程在操作系统<strong>内核程序临界区</strong>中</li>
<li>其他需要完全屏蔽中断的原子操作过程中。如加锁、解锁、中断保护现场、恢复等原子操作</li>
</ul>
</li>
<li>应该进行进程调度与切换的情况<ul>
<li>发生引起调度条件且当前进程无法继续运行下去时，可以马上进行调度与切换</li>
<li>中断处理结束或自陷处理解除后，返回被中断进程的用户态程序执行现场前，若置上请求调度标志，即可马上进行进程调度与切换</li>
</ul>
</li>
<li>进程切换<ul>
<li>保存原进程当前断点的现场信息</li>
<li>恢复被调度进程的现场信息</li>
<li>进程调度、切换是有代价的</li>
</ul>
</li>
</ul>
<p><strong>进程调度方式</strong></p>
<ul>
<li>非剥夺调度方式（非抢占方式）<ul>
<li>只能由当前运行的进程主动放弃CPU</li>
<li>实现简单，系统开销小，适用于大多数的批处理系统，但它不能用于分时操作系统和大多数的实时系统</li>
</ul>
</li>
<li>剥夺调度方式（抢占方式）<ul>
<li>可由操作系统剥夺当前进程的CPU使用权</li>
<li>对提高系统吞吐率和响应效率都有明显的好处</li>
</ul>
</li>
</ul>
<p><strong>闲逛进程</strong></p>
<ul>
<li>如果系统中没有就绪进程，就会调度闲逛进程（idle）运行，如果没有其他进程就绪，该进程就一直运行，并在执行过程中测试中断</li>
<li>优先级最低，只要有进程就绪，就会立即让出处理机</li>
<li>不需要CPU之外的资源，不会被阻塞</li>
</ul>
<p><strong>两种线程的调度</strong></p>
<ul>
<li>用户级线程调度</li>
<li>内核级线程调度</li>
</ul>
<h3 id="典型的调度算法"><a href="#典型的调度算法" class="headerlink" title="典型的调度算法"></a>典型的调度算法</h3><p><strong>先来先服务调度算法 FCFS</strong></p>
<ul>
<li>属于不可剥夺算法</li>
<li>作业/进程调度</li>
<li>优缺点<ul>
<li>算法简单，效率低</li>
<li>对长作业有利，对短作业不利</li>
<li>有利于CPU繁忙型作业，不利于I/O繁忙型作业</li>
</ul>
</li>
</ul>
<p><strong>短作业优先算法 SJF</strong></p>
<ul>
<li>默认为非抢占式</li>
<li>抢占式-最短剩余时间优先算法</li>
<li>作业（SJF）/进程调度（SPF）</li>
<li>优点<ul>
<li>SJF调度算法的平均等待时间、平均周转时间”最少“</li>
</ul>
</li>
<li>缺点<ul>
<li>长作业周转时间增加</li>
<li>不能保证紧迫性作业被及时处理</li>
<li>长作业「饥饿」现象</li>
</ul>
</li>
</ul>
<p><strong>优先级调度算法</strong></p>
<ul>
<li><p>作业/进程调度</p>
</li>
<li><p>是否能抢占</p>
<ul>
<li><p>非剥夺式优先级调度算法</p>
</li>
<li><p>剥夺式优先级调度算法</p>
</li>
</ul>
</li>
<li><p>优先级能否改变</p>
<ul>
<li><p>静态优先级</p>
<ul>
<li>优先级再创建进程时确认，运行期间保持不变</li>
</ul>
</li>
<li><p>动态优先级</p>
<ul>
<li>在进程运行过程中，根据进程情况的变化动态调整优先级</li>
</ul>
</li>
</ul>
</li>
<li><p>进程优先级设置</p>
<ul>
<li>系统进程 &gt; 用户进程</li>
<li>交互型进程 &gt; 非交互型进程（或者前台进程 &gt; 后台进程）</li>
<li>I/O型进程 &gt; 计算型进程</li>
</ul>
</li>
<li>优点<ul>
<li>用优先级区分紧急程度、重要程度，适用于实时操作系统，可灵活地调整对各种作业/进程的偏好程度</li>
</ul>
</li>
<li>缺点<ul>
<li>若源源不断地有高优先级进程到来，则可能导致饥饿</li>
</ul>
</li>
</ul>
<p><strong>高响应比优先调度算法</strong></p>
<ul>
<li>非抢占式的调度算法</li>
<li></li>
<li>作业/进程调度</li>
<li><script type="math/tex; mode=display">响应比 = \frac{等待时间 + 要求服务时间}{要求服务时间}</script></li>
<li>优缺点<ul>
<li>等待时间相同时，要求服务时间短的优先（SJF的优点）</li>
<li>要求服务时间相同时，等待时间长的优点（FCFS的优点）</li>
<li>对于长作业来说，随着等待时间越来越久，其响应比也会越来越大，从而避免了长作业饥饿的问题</li>
</ul>
</li>
</ul>
<p><strong>时间片轮转调度算法 RR</strong></p>
<ul>
<li><p>剥夺式调度算法</p>
</li>
<li><p>适用于分时系统</p>
</li>
<li>进程调度</li>
<li>时间片过大退化为FCFS，过小切换频繁，开销增大</li>
<li>时间片的长短通常由下列因素确定<ul>
<li>系统响应时间</li>
<li>就绪队列中的进程数目</li>
<li>系统的处理能力</li>
</ul>
</li>
<li>优点<ul>
<li>公平，响应快，适用于分时操作系统</li>
</ul>
</li>
<li>缺点<ul>
<li>高频率的进程切换会有一定的开销</li>
<li>不区分任务紧急程度</li>
</ul>
</li>
</ul>
<p><strong>多级队列调度算法</strong></p>
<ul>
<li>该算法在系统中设置多个就绪队列，将不同类型或性质的进程固定分配到不同的就绪队列</li>
<li>每个队列可实施不同的调度算法</li>
<li>同一队列中的进程可以设置不同的优先级，不同的队列本身也可以设置不同的优先级</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202308311526189.png" alt="image-20230831152636226"></li>
</ul>
<p><strong>多级反馈队列调度算法</strong></p>
<ul>
<li><p>抢占式</p>
</li>
<li><p>进程调度</p>
</li>
<li><p>是时间片轮转调度算法和优先级调度算法的综合和发展</p>
</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202308311523426.png" alt="image-20230831152308190"></li>
<li>优点<ul>
<li>课本<ul>
<li>终端型作业用户：短作业优先</li>
<li>短批处理作业用户：周转时间较短</li>
<li>长批处理作业用户：经过前面几个队列得到部分执行，不会长期得不到处理</li>
</ul>
</li>
<li>课件<ul>
<li>对各类型进程相对公平（FCFS的优点）</li>
<li>每个新到达的进程都可以很快就得到响应（RR的优点）</li>
<li>短进程只用较少的时间就可以完成（SPF的优点）</li>
<li>不必实现估计进程的运行时间（避免用户造假）</li>
<li>可灵活地调整对各类进程的偏好程度，比如CPU密集型进程、I/O密集型进程</li>
</ul>
</li>
</ul>
</li>
<li>会导致饥饿</li>
</ul>
<h3 id="进程切换"><a href="#进程切换" class="headerlink" title="进程切换"></a>进程切换</h3><ul>
<li>上下文切换<ul>
<li>上下文是指某一时刻CPU寄存器和程序计数器的内容</li>
<li>过程<ul>
<li>挂起一个进程，保存CPU上下文，包括程序计数器和其他寄存器</li>
<li>更新PCB信息</li>
<li>把进程的PCB移入相应的队列，如就绪、在某事件阻塞等队列</li>
<li>选择另一个进程执行，并更新其PCB</li>
<li>跳转到新进程PCB中的程序计数器所指向的位置执行</li>
<li>恢复处理机上下文</li>
</ul>
</li>
</ul>
</li>
<li>上下文的切换（即进程切换）是需要耗费资源的</li>
<li>与模式切换的区别<ul>
<li>用户态和内核态之间的切换称为模式切换</li>
<li>模式切换时，CPU逻辑上可能还在执行同一进程</li>
<li>上下文切换只能发生在内核态，他是多任务操作系统的一个必需的特性</li>
</ul>
</li>
</ul>
<h2 id="2-3同步与互斥"><a href="#2-3同步与互斥" class="headerlink" title="2.3同步与互斥"></a>2.3同步与互斥</h2><h3 id="同步与互斥的基本概念"><a href="#同步与互斥的基本概念" class="headerlink" title="同步与互斥的基本概念"></a>同步与互斥的基本概念</h3><p><strong>临界资源</strong></p>
<ul>
<li>概念：一次仅允许一个进程使用的资源称为临界资源</li>
<li><p>临界资源的访问过程</p>
<ul>
<li>进入区——负责检查是否可以进入临界区，若可以，设置正在访问临界区资源的标志（上锁）</li>
<li>临界区——访问临界资源的那段代码</li>
<li>退出区——将正在访问临界区的标志清除</li>
<li>剩余区</li>
</ul>
</li>
<li><p>```cpp<br>do{<br>entry section; // 进入区<br>critical section; // 临界区<br>exit section; // 退出区<br>remainder section; // 剩余区<br>} while(true)</p>
</li>
</ul>
<p><strong>同步―直接制约关系</strong></p>
<p><strong>互斥―间接制约关系</strong></p>
<ul>
<li>为了防止两个进程同时进入临界区，同步机制应该遵循以下原则<ul>
<li>空闲让进</li>
<li>忙则等待</li>
<li>有限等待——对请求访问的进程，应保证能在有限时间内进入临界区</li>
<li>让权等待——当进程不能进入临界区时，应立即释放处理器，防止进程忙等待 ~不一定非得实现~</li>
</ul>
</li>
</ul>
<h3 id="实现临界区互斥的基本方法"><a href="#实现临界区互斥的基本方法" class="headerlink" title="实现临界区互斥的基本方法"></a>实现临界区互斥的基本方法</h3><p><strong>软件实现方法</strong></p>
<ul>
<li>单标志法<ul>
<li>思想：两个进程在访问完临界区后会把使用临界区的权限转交给另一个进程。也就是每个进程进入临界区的权限只能被另一个进程赋予</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202308311700037.png" alt="image-20230831170041925"></li>
<li>违背“空闲让进”——两个进程必须交替进入临界区，若某个进程不再进入临界区，则另一个进程也将无法进入临界区，造成资源利用不充分</li>
</ul>
</li>
<li>双标志法先检查<ul>
<li>思想——在每个进程访问临界区资源之前，先查看临界资源是否正在被访问，若正被访问，该进程需等待；否则，进程才进入自己的临界区。</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202308311711985.png" alt="image-20230831171112985"></li>
<li>违背“忙则等待”——按照①⑤②⑥③⑦…的顺序执行，P0和P1会同时访问临界区——进入区的“检查”和”上锁“两个处理不是一气呵成的</li>
<li>优点——不用交替进入，可连续使用</li>
</ul>
</li>
<li>双标志法后检查<ul>
<li>思想——先将自己的标志设置为TRUE，再检查对方的状态标志，若对方标志为TRUE，则进程等待，否则进入临界区</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202308311717270.png" alt="image-20230831171722602"></li>
<li>违背了”空闲让进“和”有限等待“——产生”饥饿“现象——按照①⑤②⑥…的顺序执行，P0和P1都将无法进入临界区——两个进程几乎同时都想进入临界区时，他们分别将自己的标志置为TRUE，并且同时检查对方的状态，发现对方也要进入临界区，双方互相谦让，结果谁也进不了临界区</li>
</ul>
</li>
<li>Peterson’s Algorithm<ul>
<li>结合双标志法、单标志法的思想</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202308311734452.png" alt="image-20230831173447377"></li>
<li>遵循了空闲让进、忙则等待、有限等待三个原则，但是未遵循让权等待的原则——进入区会一直卡在while循环，没有及时释放资源</li>
</ul>
</li>
</ul>
<p><strong>硬件实现方法（低级方法，元方法）</strong></p>
<ul>
<li><p>中断屏蔽方法（屏蔽中断，关中断）</p>
<ul>
<li>```<br>…<br>关中断;<br>临界区;<br>开中断;<br>…<br>// 关中断后即不允许当前进程被中断，也必然不会发生进程切换<pre class="line-numbers language-none"><code class="language-none">
  - 优点：简单、高效（很方便）

  - 缺点：

    - 限制了处理机交替执行的能力，执行的效率会明显降低
    - 不适用于多处理机
    - 只适用于操作系统内核进程（开/关中断指令只能运行在内核态，让用户随意使用会很危险）

- 硬件指令方法

  - 硬件实现—原子操作—不允许中断
  - TestAndSet指令
    - ![image-20230831184916916](https://gitee.com/renmale-sztu/image/raw/master/202308311849954.png)
  - Swap指令
    - ![image-20230831184956966](https://gitee.com/renmale-sztu/image/raw/master/202308311849272.png)
  - 优点： 
    - 适用于任意数目的进程，而不管是单处理机还是多处理机
    - 简单容易检验正确性 
    - 可以支持进程内有多个临界区
  - 缺点
    - 进程等待进入临界区时要耗费处理机时间，不能实现让权等待，导致”饥饿“现象

### 互斥锁

- 解决临界区最简单的工具就是互斥锁
- 进入临界区获得锁，退出临界区释放锁
- 函数acquire()获得锁，release()释放锁——原子操作
- 需要连续循环忙等的互斥锁，都可称为自旋锁，如TSL指令、swap指令、单标志法
- 缺点
  - 需忙等，进程时间片用完才下处理机，违反”让权等待“
  - 不太适用于单处理机系统，忙等的过程中不可能解锁

- 优点：
  - 等待期间不用切换进程上下文，多处理器系统中，若上锁的时间短，则等待代价很低
  - 常用于多处理器系统，一个核忙等，其他核照常工作，并快速释放临界区、

### 信号量

**信号量**

- 概念：只能被两个标准的原语 wait(S) 和 signal(S) 访问，也可以记作 P操作和V操作
- PV操作——低级进程通信原语
- 原语——完成某种功能且不被分割、不被中断执行的操作序列——屏蔽中断方式

**整型信号量**

- 一个用于表示资源数目的整型量S

- ```cpp
  int S = 1; 		//初始化整形信号量S，表示当前系统中可用的打印机资源数
  
  void wait(int S){	//wait原语，相当于“进入区”
  	while(S &lt;= 0);	//如果资源数不够，就一直循环等待
  	S--;			//如果资源数够，就占用一个资源
  }	
  
  void signal(int S){	//signal原语，相当于“退出区”
  	S++;			//使用完资源后，在退出区释放资源
  }

- 只要信号量$S\le0$，就会不断测试。违背“让权等待”

**记录型信号量**

- 一种不存在“忙等”现象的进程同步机制
- ```cpp
  // 记录型信号量的定义
  typedef struct{
  	int value;				//剩余资源数
  	struct process *L;		//等待队列
  }semaphore;
  
  // 某进程需要使用资源时，通过wait原语申请
  void wait(semaphore S){
  	S.value--;
  	if(S.value &lt; 0){
  		block(S.L);		//block原语，进程自我阻塞，并插入到该资源的等待队列
  	}
  }
  
  void signal(semaphore S){ // 相当于释放资源
  	S.value++;
  	if(S.value &lt;= 0){
  		wakeup(P);		//wakeup原语，将该资源等待队列中的第一个进程唤醒
  	}
  }

**利用信号量实现同步**

- 初值为0
- 前V后P
  - 在“前操作”之后执行V(S)
  - 在“后操作”之前执行P(S)

  - ```cpp
  semaphore S = 0; // 初始化信号量，初始值位0
  P1(){
  	x;		// x语句
  	V(S);   // 告诉进程2，语句x已经完成
  }
  
  P2(){
  	P(S);   // 检查语句x是否运行完成
  	y;		// 检查无误，运行y语句
  }

**利用信号量实现进程互斥**

- 初值为1
- 对不同的临界资源需要设置不同的互斥信号量

 - ```cpp
    semaphore S = 1; // 初始化信号量，初始值位1
    P1(){
      ...
      P(S)				//加锁

  	进程1的临界区;
  	V(S);				//解锁
  	  ...
  }

  P2(){
  	...
      P(S)		
  	进程2的临界区;
  	V(S);
      ...
  }

**利用信号量实现前驱关系**

- ![image-20230901162736897](https://gitee.com/renmale-sztu/image/raw/master/202309011627623.png)

### 管程

- 概念
  - 统一管理共享资源的所有访问，实现进程互斥，这个代表共享资源的数据结构，以及由对该共享数据结构实施操作的一组过程所组成的资源管理程序，称为管程
  - 一种语法范围，无法创建和撤销
- 组成
  - 管程的名称
  - 局部于管程内部的共享结构数据说明
  - 对该数据结构进行操作的一组过程（或函数）
  - 对局部于管程内部的共享数据设置初始值的语句
- 特征
  - 局部于管程的数据只能被局部于管程的过程所访问
  - 一个进程只有通过调用管城内的过程才能进入管程访问共享数据
  - 每次仅允许一个进程在管程内执行某个内部过程（★）

- 条件变量 condition
  - 表示阻塞原因，可以有多个
  - x.wait
    - 当x对应的条件不满足时，正在调用管程的进程调用x.wait将自己插入x条件的等待队列，并释放管程。此时其他进程可以使用该管程

  - x.signal
    - x对应的条件发生了变化，则调用x.signal，唤醒一个因x条件而阻塞的进程

- ![image-20230901184035807](https://gitee.com/renmale-sztu/image/raw/master/202309011840437.png)

- V操作一定改变信号量的值，signal不一定

### 经典同步问题  

**生产者-消费者问题**

- 问题描述
  - 系统中有一组生产者进程和一组消费者进程，生产者进程每次生产一个产品放入缓冲区，消费者进程每次从缓冲区中取出一个产品并使用。（注：这里的“产品”理解为某种数据）
  - 生产者、消费者共享一个初始为空、大小为n的缓冲区。
  - 只有缓冲区没满时，生产者才能把产品放入缓冲区，否则必须等待。
  - 只有缓冲区不空时，消费者才能从中取出产品，否则必须等待。
  - 缓冲区是临界资源，各进程必须互斥地访问。
- ![image-20230901165651086](https://gitee.com/renmale-sztu/image/raw/master/202309011656115.png)
- 交换两个P操作的顺序——导致死锁——实现互斥的P操作一定要在实现同步的P操作之后
- 两个V操作的顺序可以交换

**多生产者-多消费者问题**

- 问题描述
  - 桌子上有一只盘子，每次只能向其中放入一个水果。爸爸专向盘子中放苹果，妈妈专向盘子中放橘子，儿子专等着吃盘子中的橘子，女儿专等着吃盘子中的苹果。只有盘子空时，爸爸或妈妈才可向盘子中放一个水果。仅当盘子中有自己需要的水果时，儿子或女儿可以从盘子中取出水果。用PV操作实现上述过程。
  - 互斥关系
    - 对缓冲区（盘子）的访问要互斥进行
  - 同步关系
    - 父亲将苹果放入盘子后，女儿才能取苹果
    - 母亲将橘子放入盘子后，儿子才能取橘子
    - 只有盘子为空时，父亲/母亲才能放入水果
- ![image-20230901190031019](https://gitee.com/renmale-sztu/image/raw/master/202309011900105.png)
- 上诉代码中可以取消互斥信号量吗
  - 可以，当缓冲区大小为1时可以不使用互斥信号量，程序也可以正常运行

**读者-写者问题**

- 问题描述
  - 允许多个读者可以同时对文件执行读操作
    - 与消费者进程不同，读者进程在读数据后并不会将数据清空，不会改变数据
  - 只允许一个写者往文件中写信息
  - 任一写者在完成写操作之前不允许其他读者或写者工作
  - 写者执行写操作前，应让已有的读者和写者全部退出。
- 互斥关系
  - 读进程—读进程
  - 写进程—写进程
- ![image-20230901193650356](https://gitee.com/renmale-sztu/image/raw/master/202309011936331.png)
  - 如果没有mutex互斥量
    - 如果没有mutex互斥量，可能存在两个进程同时访问rw互斥量，count变量的修改和rw互斥量的上锁/解锁不是一气呵成的
  - 如果没有w互斥量——写进程饿死
    - 源源不断的读者进程
    - 只有最后一个读者进程会释放rw互斥量

**哲学家进餐问题**

- 问题描述

  - 一张圆桌上坐着5名哲学家，每两个哲学家之间的桌上摆一根筷子，桌子的中间是一碗米饭。哲学家们倾注毕生的精力用于思考和进餐，哲学家在思考时，并不影响他人。只有当哲学家饥饿时，才试图拿起左、右两根筷子（一根一根地拿起）。如果筷子已在他人手上，则需等待。饥饿的哲学家只有同时拿起两根筷子才可以开始进餐，当进餐完毕后，放下筷子继续思考。
  - ![image-20230901200247747](https://gitee.com/renmale-sztu/image/raw/master/202309012002779.png)

- 死锁——五个哲学家一人一只筷子

- 解决

  - 各哲学家互斥地拿筷子
  - 最多允许四个哲学家同时进餐
  - 奇数号哲学家先拿左边筷子，偶数号相反
  - ......

- ```c++
  semaphore chopstick[5]={1, 1, 1, 1, 1};
  semaphore mutex = 1;			// 互斥地取筷子
  Pi(){
  	while(1){
  		P(mutex);
  		P(chopstick[i]);		// 拿左
  		P(chopstick[i+1]%5);	// 拿右
  		V(mutex);
  		吃饭...
  		P(chopstick[i]);		// 放左
  		P(chopstick[i+1]%5);	// 放右
  		思考...
  	}
  }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
</li>
</ul>
<p><strong>吸烟者问题</strong></p>
<ul>
<li>问题描述<ul>
<li>假设一个系统有<strong>三个抽烟者进程</strong>和<strong>一个供应者进程</strong>。每个抽烟者不停地卷烟并抽掉它，但是要卷起并抽掉一支烟，抽烟者需要有三种材料：烟草、纸和胶水。三个抽烟者中，第一个拥有烟草、第二个拥有纸、第三个拥有胶水。供应者进程无限地提供三种材料，供应者每次将两种材料放桌子上，拥有剩下那种材料的抽烟者卷一根烟并抽掉它，并给供应者进程一个信号告诉完成了，供应者就会放另外两种材料再桌上，这个过程一直重复（让三个抽烟者<strong>轮流</strong>地抽烟）</li>
<li>“可生产多种产品的单生产者-多消费者”问题</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309011915547.png" alt="image-20230901191506660"></li>
</ul>
</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309011915093.png" alt="image-20230901191526884"></li>
</ul>
<h2 id="2-4死锁"><a href="#2-4死锁" class="headerlink" title="2.4死锁"></a>2.4死锁</h2><h3 id="死锁的概念"><a href="#死锁的概念" class="headerlink" title="死锁的概念"></a>死锁的概念</h3><p><strong>死锁的定义</strong></p>
<ul>
<li>概念<ul>
<li>各进程互相等待对方手里的资源，导致各进程都阻塞，无法向前推进的现象</li>
</ul>
</li>
<li>死锁、饥饿、死循环<ul>
<li>死锁<ul>
<li>至少有两个或两个以上的进程同时发生死锁</li>
</ul>
</li>
<li>饥饿<ul>
<li>概念——由于长期得不到想要的资源，某进程无法向前推进的现象</li>
<li>可能只有一个进程发生饥饿</li>
</ul>
</li>
<li>死循环<ul>
<li>概念——某进程执行过程中一直跳不出某个循环的现象</li>
<li>死锁和饥饿时管理者（操作系统）的问题，死循环是被管理者的问题</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>死锁产生的原因</strong></p>
<ul>
<li>系统资源的竞争<ul>
<li>通常系统中拥有的不可剥夺资源，其数量不足以满足多个进程运行的需要</li>
<li>只有对不可剥夺资源的竞争会产生死锁</li>
</ul>
</li>
<li>进程推进顺序非法<ul>
<li>进程在运行过程中，请求和释放资源的顺序不当</li>
</ul>
</li>
<li>信号量使用不当<ul>
<li>进程间彼此等待对方发来的消息</li>
</ul>
</li>
</ul>
<p><strong>死锁产生的必要条件</strong>（必要而非充分条件）</p>
<ul>
<li>互斥条件<ul>
<li>一段时间内某资源仅为一个进程所占有</li>
</ul>
</li>
<li>不剥夺条件<ul>
<li>进程所获得的资源在未使用完之前，不能被其他进程强行夺走，即只能由获得该资源的进程自己来释放</li>
</ul>
</li>
<li>请求并保持条件<ul>
<li>进程已经保持了至少一个资源，但又提出了新的资源请求，而该资源又被其他进程占有，此时请求进程被阻塞，但又对自己已有的资源保持不放</li>
</ul>
</li>
<li>循环等待条件<ul>
<li>存在一种进程资源的循环等待链，链中的每一个进程已获得的资源同时被下一个进程所请求</li>
</ul>
</li>
</ul>
<p><strong>死锁的处理策略</strong></p>
<ul>
<li><p>设法破坏死锁的4个必要条件之一，或允许死锁产生，但当死锁发生时能检测出死锁，并有能力恢复</p>
<ul>
<li><p>死锁预防</p>
<ul>
<li>破坏死锁产生的四个必要条件中的一个或几个</li>
</ul>
</li>
<li><p>避免死锁</p>
<ul>
<li>用某种方法防止系统进入不安全状态，从而避免死锁（银行家算法）</li>
</ul>
</li>
<li><p>死锁的检测及解除</p>
<ul>
<li>允许死锁的发生，不过操作系统会负责检测出死锁的发生，然后采取某种措施解除死锁</li>
</ul>
</li>
</ul>
</li>
<li><p>事先预防策略</p>
<ul>
<li>死锁预防</li>
<li>死锁避免</li>
</ul>
</li>
<li><p><img src="https://gitee.com/renmale-sztu/image/raw/master/202309021437402.png" alt="image-20230902143700140"></p>
</li>
</ul>
<h3 id="预防死锁"><a href="#预防死锁" class="headerlink" title="预防死锁"></a>预防死锁</h3><ul>
<li><p>静态策略</p>
</li>
<li><p>破坏互斥条件</p>
<ul>
<li>若允许系统资源都能共享使用，则系统不会进入死锁状态</li>
<li>缺点<ul>
<li>为了系统安全，很多地方还需要保护这种互斥性，因此，很多时候都无法破坏互斥条件</li>
</ul>
</li>
</ul>
</li>
<li>破坏不剥夺条件<ul>
<li>当一个已保持了某些不可剥夺资源的进程请求新的资源而得不到满足时，它必须释放已经保持的所有资源</li>
<li>缺点<ul>
<li>实现复杂</li>
<li>释放已获得的资源可能造成前一阶段工作的失效，只适用于易保存和恢复状态的资源，如CPU</li>
<li>反复地申请和释放资源会增加系统开销，降低系统吞吐量</li>
<li>可能导致饥饿</li>
</ul>
</li>
</ul>
</li>
<li>破坏请求并保持条件<ul>
<li>静态分配方法<ul>
<li>一次申请所有资源，资源未满足前，不让它投入运行，一旦投入，资源一直归它所有</li>
</ul>
</li>
<li>实现简单</li>
<li>缺点<ul>
<li>系统资源被严重浪费</li>
<li>可能导致饥饿</li>
</ul>
</li>
</ul>
</li>
<li>破坏循环等待条件<ul>
<li>顺序资源分配法<ul>
<li>可采用顺序资源分配法。首先给系统中的资源编号，规定每个进程须按编号递增的顺序请求资源，同类资源（即编号相同的资源）一次申请完</li>
<li>只要进程提出申请<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.457ex" height="1.902ex" role="img" focusable="false" viewBox="0 -683 1086 840.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></g><g data-mml-node="mi" transform="translate(792,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>资源，以后只能申请编号大于<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.457ex" height="1.902ex" role="img" focusable="false" viewBox="0 -683 1086 840.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></g><g data-mml-node="mi" transform="translate(792,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>的资源</li>
</ul>
</li>
<li>缺点<ul>
<li>不方便增加新的设备，因为可能需要重新分配所有的编号</li>
<li>进程实际使用资源的顺序可能和编号递增顺序不一致，会导致资源浪费</li>
<li>必须按规定次序申请资源，用户编程麻烦</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="死锁避免"><a href="#死锁避免" class="headerlink" title="死锁避免"></a>死锁避免</h3><ul>
<li>动态策略</li>
</ul>
<p><strong>系统安全状态</strong></p>
<ul>
<li>安全状态<ul>
<li>所谓安全状态，是指系统能按某种进程推进的顺序（<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="13.527ex" height="1.984ex" role="img" focusable="false" viewBox="0 -683 5979 877"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(675,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="mo" transform="translate(1078.6,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msub" transform="translate(1523.2,0)"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(675,-150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(2601.8,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mo" transform="translate(3046.4,0)"><path data-c="2026" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60ZM525 60Q525 84 542 102T585 120Q609 120 627 104T646 61Q646 36 629 18T586 0T543 17T525 60ZM972 60Q972 84 989 102T1032 120Q1056 120 1074 104T1093 61Q1093 36 1076 18T1033 0T990 17T972 60Z"></path></g><g data-mml-node="mo" transform="translate(4385.1,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msub" transform="translate(4829.8,0)"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(675,-150) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>）为每个进<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.192ex" height="1.902ex" role="img" focusable="false" viewBox="0 -683 969 840.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(675,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>分配其所需的资源，直至满足每个进程对资源的最大需求，使每个进程都可顺序完成，此时称<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="13.527ex" height="1.984ex" role="img" focusable="false" viewBox="0 -683 5979 877"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(675,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="mo" transform="translate(1078.6,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msub" transform="translate(1523.2,0)"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mn" transform="translate(675,-150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(2601.8,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mo" transform="translate(3046.4,0)"><path data-c="2026" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60ZM525 60Q525 84 542 102T585 120Q609 120 627 104T646 61Q646 36 629 18T586 0T543 17T525 60ZM972 60Q972 84 989 102T1032 120Q1056 120 1074 104T1093 61Q1093 36 1076 18T1033 0T990 17T972 60Z"></path></g><g data-mml-node="mo" transform="translate(4385.1,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msub" transform="translate(4829.8,0)"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(675,-150) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>为安全序列，</li>
<li>若系统无法找到一个安全序列，则称系统处于不安全状态</li>
</ul>
</li>
<li>并非所有的不安全状态都是死锁状态<ul>
<li>系统进入不安全状态，有可能死锁</li>
<li>系统处于安全状态，一定不可能死锁</li>
</ul>
</li>
</ul>
<p><strong>银行家算法</strong></p>
<ul>
<li><p>思想</p>
<ul>
<li>在进程提出资源申请时，先预判此次分配是否会导致系统进入不安全态，如果会进入不安全状态，就暂时不答应这次请求，让该进程先阻塞等待</li>
</ul>
</li>
<li><p>数据结构描述</p>
<ul>
<li>最大需求矩阵Max<ul>
<li>各进程对资源的最大需求数</li>
</ul>
</li>
<li>分配矩阵Alocation<ul>
<li>已经给各进程分配了多少资源</li>
</ul>
</li>
<li>需求矩阵Need<ul>
<li>各进程最多还需要多少资源</li>
<li>Need = Max - Allocation</li>
</ul>
</li>
<li>一维数组 Available<ul>
<li>表示还有多少可用资源</li>
</ul>
</li>
</ul>
</li>
<li><p>银行家算法描述</p>
<ul>
<li>用长度为m的一维数组 Request表示进程此次申请的各种资源数</li>
</ul>
<ol>
<li>如果 Requesti[j]≤Need[i, j] (0<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.312ex;" xmlns="http://www.w3.org/2000/svg" width="1.76ex" height="1.751ex" role="img" focusable="false" viewBox="0 -636 778 774"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2264" d="M674 636Q682 636 688 630T694 615T687 601Q686 600 417 472L151 346L399 228Q687 92 691 87Q694 81 694 76Q694 58 676 56H670L382 192Q92 329 90 331Q83 336 83 348Q84 359 96 365Q104 369 382 500T665 634Q669 636 674 636ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path></g></g></g></svg></mjx-container>j<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.312ex;" xmlns="http://www.w3.org/2000/svg" width="1.76ex" height="1.751ex" role="img" focusable="false" viewBox="0 -636 778 774"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2264" d="M674 636Q682 636 688 630T694 615T687 601Q686 600 417 472L151 346L399 228Q687 92 691 87Q694 81 694 76Q694 58 676 56H670L382 192Q92 329 90 331Q83 336 83 348Q84 359 96 365Q104 369 382 500T665 634Q669 636 674 636ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path></g></g></g></svg></mjx-container>m)便转向②；否则认为出错，因为它所需要的资源数已超过它所宣布的最大值。</li>
<li>如果 Requesti[j]≤Available[j] (0<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.312ex;" xmlns="http://www.w3.org/2000/svg" width="1.76ex" height="1.751ex" role="img" focusable="false" viewBox="0 -636 778 774"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2264" d="M674 636Q682 636 688 630T694 615T687 601Q686 600 417 472L151 346L399 228Q687 92 691 87Q694 81 694 76Q694 58 676 56H670L382 192Q92 329 90 331Q83 336 83 348Q84 359 96 365Q104 369 382 500T665 634Q669 636 674 636ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path></g></g></g></svg></mjx-container>j<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.312ex;" xmlns="http://www.w3.org/2000/svg" width="1.76ex" height="1.751ex" role="img" focusable="false" viewBox="0 -636 778 774"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2264" d="M674 636Q682 636 688 630T694 615T687 601Q686 600 417 472L151 346L399 228Q687 92 691 87Q694 81 694 76Q694 58 676 56H670L382 192Q92 329 90 331Q83 336 83 348Q84 359 96 365Q104 369 382 500T665 634Q669 636 674 636ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path></g></g></g></svg></mjx-container>m)，便转向③ ；否则表示尚无足够资源，Pi必须等待</li>
<li>系统试探着把资源分配给进程Pi，并修改相应的数据（并非真的分配，修改数值只是为了做预判）：<ul>
<li>Available = Available - Requesti;</li>
<li>Allocation[i, j] = Allocation[i, j] + Requesti[j];</li>
<li>Need[i, j] = Need[i, j] – Requesti[j]</li>
</ul>
</li>
<li>操作系统执行安全性算法，检查此次资源分配后，系统是否处于安全状态。若安全，才正式分配；否则，恢复相应数据，让进程阻塞等待</li>
</ol>
</li>
<li><p>安全性算法</p>
<ul>
<li>检查当前的剩余可用资源是否能满足某个进程的最大需求，如果可以，就把该进程加入安全序列，并把该进程持有的资源全部回收</li>
<li>不断重复上述过程，看最终是否能让所有进程都加入安全序列</li>
</ul>
</li>
</ul>
<h3 id="死锁检测和解除"><a href="#死锁检测和解除" class="headerlink" title="死锁检测和解除"></a>死锁检测和解除</h3><p><strong>资源分配图</strong></p>
<ul>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309021525964.png" alt="image-20230902152540879" style="zoom: 67%;"></li>
<li>圆圈代表一个进程</li>
<li>框代表一类资源，框中的一个圆表示该类的一个资源</li>
<li>从进程到资源的有向边称为请求边，表示该进程申请一个单位的该类资源</li>
<li>从资源到进程的边称为分配边，表示该类资源已有一个资源分配给了该进程</li>
</ul>
<p><strong>死锁定理</strong></p>
<ul>
<li>在资源分配图中，找出既不阻塞又不是孤点的进程 Pi（即找出一条有向边与它相连，且该有向边对应资源的申请数量小于等于系统中已有空闲资源数量。如上图中，R1没有空闲资源，R2有一个空闲资源。若所有的连接该进程的边均满足上述条件，则这个进程能继续运行直至完成，然后释放它所占有的所有资源）。消去它所有的请求边和分配变，使之称为孤立的结点。在下图中，P1 是满足这一条件的进程结点，于是将P1的所有边消去</li>
<li>进程 Pi 所释放的资源，可以唤醒某些因等待这些资源而阻塞的进程，原来的阻塞进程可能变为非阻塞进程。在上图中，P2 就满足这样的条件。根据（1）中的方法进行一系列简化后，若能消去途中所有的边，则称该图是可完全简化的。</li>
<li><img src="https://gitee.com/renmale-sztu/image/raw/master/202309021531843.png" alt="image-20230902153140746"></li>
<li>死锁定理<ul>
<li>如果某时刻系统的资源分配图是不可完全简化的，那么此时系统死锁</li>
</ul>
</li>
</ul>
<p><strong>死锁解除</strong></p>
<ul>
<li>资源剥夺法<ul>
<li>挂起（暂时放到外存上）某些死锁进程，并抢占它的资源，将这些资源分配给其他的死锁进程。但是应防止被挂起的进程长时间得不到资源而饥饿</li>
</ul>
</li>
<li>撤销进程法<ul>
<li>强制撤销部分、甚至全部死锁进程，并剥夺这些进程的资源。这种方式的优点是实现简单，但所付出的代价可能会很大。因为有些进程可能已经运行了很长时间，已经接近结束了，一旦被终止可谓功亏一篑，以后还得从头再来</li>
</ul>
</li>
<li>进程回退法<ul>
<li>让一个或多个死锁进程回退到足以避免死锁的地步。这就要求系统要记录进程的历史信息，设置还原点</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/02/28/CMAKE%E4%BA%86%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="renmale-lv">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="renmale-lv blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | renmale-lv blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/02/28/CMAKE%E4%BA%86%E8%A7%A3/" class="post-title-link" itemprop="url">CMAKE了解</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-02-28 14:16:05" itemprop="dateCreated datePublished" datetime="2023-02-28T14:16:05+08:00">2023-02-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-05-15 13:54:05" itemprop="dateModified" datetime="2023-05-15T13:54:05+08:00">2023-05-15</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>7.9k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>7 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://modern-cmake-cn.github.io/Modern-CMake-zh_CN/">Modern CMake 简体中文版</a><br><a target="_blank" rel="noopener" href="http://file.ncnynl.com/ros/CMake%20Practice.pdf">CMake实践</a></p>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><h2 id="为什么要使用CMAKE？"><a href="#为什么要使用CMAKE？" class="headerlink" title="为什么要使用CMAKE？"></a>为什么要使用CMAKE？</h2><ul>
<li>你需要在不止一台电脑上构建软件包</li>
<li>你想使用IDE，但也许不总是使用</li>
<li>你需要支持不同的操作系统（甚至可能只是Unix的不同版本）</li>
<li>你想支持多个编译器</li>
<li>你想使用一个第三方库</li>
<li>……</li>
</ul>
<p>CMake的生态极好，大部分的IDE都支持CMake（或者是CMake支持那个IDE）。如果你想要在你的代码中包含一个库，你有两个选择，要么自己写一个构建系统，要么使用该库支持的构建系统中的某个。而那通常包含 CMake。 如何你的工程包含的库多了，CMake 或很快成为那些库所支持的构建系统的交集</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2023/02/28/CMAKE%E4%BA%86%E8%A7%A3/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/02/19/C++%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="renmale-lv">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="renmale-lv blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | renmale-lv blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/02/19/C++%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%9F%BA%E7%A1%80/" class="post-title-link" itemprop="url">C++多线程基础</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-02-19 17:57:15" itemprop="dateCreated datePublished" datetime="2023-02-19T17:57:15+08:00">2023-02-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-04-07 15:28:31" itemprop="dateModified" datetime="2023-04-07T15:28:31+08:00">2023-04-07</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>28k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>26 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <meta name="referrer" content="no-referrer">

<label style="color:yellow">记笔记时翻阅了一些其他大佬的资料，如有侵权，联系我删除</label>

<h1 id="一、并发、进程、线程"><a href="#一、并发、进程、线程" class="headerlink" title="一、并发、进程、线程"></a>一、并发、进程、线程</h1><h2 id="1-概念"><a href="#1-概念" class="headerlink" title="1 概念"></a>1 概念</h2><p><strong>并发</strong>：两个或者更多的任务<del>同时发生</del>（实际上是多个任务轮流占有处理器），某一时刻只能执行一个任务：由于操作系统调度，每秒钟进行多次所谓的“任务切换”，这种切换（上下文切换）死有时间开销的。  </p>
<p><img src="https://gitee.com/renmale-sztu/image/raw/master/img/202302272053004.png" alt="img"></p>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">并发是指一个处理器同时处理多个任务
并行是指多个处理器或者是多核的处理器同时处理多个不同的任务
并发是逻辑上的同时发生，而并行是物理上的同时发生
并发是一个人同时吃三个馒头，而并行的3个人同时吃三个馒头<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2023/02/19/C++%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%9F%BA%E7%A1%80/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/12/02/%E5%9B%9E%E6%96%87%E8%87%AA%E5%8A%A8%E6%9C%BA-PAM/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="renmale-lv">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="renmale-lv blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | renmale-lv blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/12/02/%E5%9B%9E%E6%96%87%E8%87%AA%E5%8A%A8%E6%9C%BA-PAM/" class="post-title-link" itemprop="url">回文自动机(PAM)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-12-02 14:49:02" itemprop="dateCreated datePublished" datetime="2022-12-02T14:49:02+08:00">2022-12-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-02-24 23:33:52" itemprop="dateModified" datetime="2023-02-24T23:33:52+08:00">2023-02-24</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>2.3k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>2 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <meta name="referrer" content="no-referrer">

<h2 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h2><p>​    给定一个字符串<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="1.061ex" height="1.023ex" role="img" focusable="false" viewBox="0 -442 469 452"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g></g></g></svg></mjx-container>，求字符串<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="1.061ex" height="1.023ex" role="img" focusable="false" viewBox="0 -442 469 452"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g></g></g></svg></mjx-container>有多少个不同的回文子串？</p>
<p>​    如果使用<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="10.486ex" height="1.595ex" role="img" focusable="false" viewBox="0 -694 4635 705"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g><g data-mml-node="mi" transform="translate(1051,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(1580,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(2180,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(2709,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mi" transform="translate(3142,0)"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g><g data-mml-node="mi" transform="translate(3718,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(4184,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg></mjx-container>算法来获得字符串中每个字符为中心的最长回文半径，再用<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="5.57ex" height="1.595ex" role="img" focusable="false" viewBox="0 -694 2462 705"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path></g><g data-mml-node="mi" transform="translate(888,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(1417,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mi" transform="translate(1886,0)"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g></g></g></svg></mjx-container>来查重所有的回文子串，时间复杂度为<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="6.606ex" height="2.452ex" role="img" focusable="false" viewBox="0 -833.9 2919.8 1083.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D442" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path></g><g data-mml-node="mo" transform="translate(763,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msup" transform="translate(1152,0)"><g data-mml-node="mi"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mn" transform="translate(975.3,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(2530.8,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container><del>（如果使用其他查重方式，时间复杂度可能更高）</del>，而<strong>回文自动机</strong>则能够以<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="5.495ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2429 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D442" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path></g><g data-mml-node="mo" transform="translate(763,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1152,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(2040,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>的时间复杂度来完成一些<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="10.486ex" height="1.595ex" role="img" focusable="false" viewBox="0 -694 4635 705"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g><g data-mml-node="mi" transform="translate(1051,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(1580,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(2180,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(2709,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mi" transform="translate(3142,0)"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g><g data-mml-node="mi" transform="translate(3718,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(4184,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg></mjx-container>算法难以处理的回文串问题。</p>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>​    回文自动机，也叫回文树，是一种在2014年发明的数据结构。</p>
<p>​    回文自动机，就是使用字典树来保存所有回文子串的回文半径，使用两棵树来分别保存偶数串和奇数串，<del>也可以像<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="10.486ex" height="1.595ex" role="img" focusable="false" viewBox="0 -694 4635 705"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g><g data-mml-node="mi" transform="translate(1051,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(1580,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(2180,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(2709,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mi" transform="translate(3142,0)"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g><g data-mml-node="mi" transform="translate(3718,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(4184,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg></mjx-container>一样通过插入无意义的字符来只构建一棵树，但是这样处理起来比较麻烦</del>，在树上的一个节点代表一个回文子串，在最后使用节点数-2（减去两个根节点）就得到了不同回文子串的位置。</p>
<p>​    对于一个已知的字符串<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="13.294ex" height="1.595ex" role="img" focusable="false" viewBox="0 -694 5876 705"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(529,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(958,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(1387,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mi" transform="translate(1820,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(2249,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(2678,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(3107,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mi" transform="translate(3540,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(3969,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(4398,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(4827,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(5356,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g></svg></mjx-container>，假设我们已经遍历了<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="9.95ex" height="1.595ex" role="img" focusable="false" viewBox="0 -694 4398 705"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(529,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(958,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(1387,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mi" transform="translate(1820,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(2249,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(2678,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(3107,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mi" transform="translate(3540,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(3969,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g></g></g></svg></mjx-container>，当我们遍历下一个字符<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="0.971ex" height="1.595ex" role="img" focusable="false" viewBox="0 -694 429 705"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g></g></g></svg></mjx-container>时，会进行如下判断：</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2022/12/02/%E5%9B%9E%E6%96%87%E8%87%AA%E5%8A%A8%E6%9C%BA-PAM/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/29/Trie/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="renmale-lv">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="renmale-lv blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | renmale-lv blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/11/29/Trie/" class="post-title-link" itemprop="url">Trie</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-11-29 12:27:13" itemprop="dateCreated datePublished" datetime="2022-11-29T12:27:13+08:00">2022-11-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-05 21:01:30" itemprop="dateModified" datetime="2023-09-05T21:01:30+08:00">2023-09-05</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>915</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <meta name="referrer" content="no-referrer">

<h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>字典树也叫Trie树、前缀树，是一种针对字符串进行维护的<strong>数据结构</strong>，而不是算法。</p>
<p>字典树是对字符串的一种存储的方式，这棵树的根节点到某一个目标节点的路径就是一个字符串（单词）。</p>
<p>举个例子，下图的字典树：</p>
<p><img src="https://gitee.com/renmale-sztu/image/raw/master/img/202212212057021.png" alt="202211291950874"></p>
<p>该字典树存储的单词为：</p>
<pre class="line-numbers language-none"><code class="language-none">a
abc
ba
bca
bca
ca
ca<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2022/11/29/Trie/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/29/Manacher/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="renmale-lv">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="renmale-lv blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | renmale-lv blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/11/29/Manacher/" class="post-title-link" itemprop="url">Manacher</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-11-29 01:36:05" itemprop="dateCreated datePublished" datetime="2022-11-29T01:36:05+08:00">2022-11-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-03-22 09:50:13" itemprop="dateModified" datetime="2023-03-22T09:50:13+08:00">2023-03-22</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>2k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>2 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <meta name="referrer" content="no-referrer">        

<p>​    给定一个字符串<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="13.294ex" height="1.595ex" role="img" focusable="false" viewBox="0 -694 5876 705"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(529,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(958,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(1387,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mi" transform="translate(1820,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(2249,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(2678,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(3107,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mi" transform="translate(3540,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(3969,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(4398,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mi" transform="translate(4827,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(5356,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g></svg></mjx-container>，求该字符串的最长回文子串的长度。</p>
<h3 id="暴力匹配"><a href="#暴力匹配" class="headerlink" title="暴力匹配"></a>暴力匹配</h3><p>​        两个<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="3.362ex" height="2.059ex" role="img" focusable="false" viewBox="0 -705 1486 910"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mi" transform="translate(550,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(1035,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg></mjx-container>循环遍历所有子串，再判断所有子串是否回文，再通过比较获取最长回文子串长度，算法复杂度为<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="6.606ex" height="2.451ex" role="img" focusable="false" viewBox="0 -833.2 2919.8 1083.2"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D442" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path></g><g data-mml-node="mo" transform="translate(763,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msup" transform="translate(1152,0)"><g data-mml-node="mi"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mn" transform="translate(975.3,363) scale(0.707)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path></g></g><g data-mml-node="mo" transform="translate(2530.8,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></p>
<p><img src="https://gitee.com/renmale-sztu/image/raw/master/img/202212212100439.png" alt="image-20221221210004388"></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2022/11/29/Manacher/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">renmale-lv</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>Word count total: </span>
    <span title="Word count total">88k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>Reading time total &asymp;</span>
    <span title="Reading time total">1:20</span>
  </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>
<!-- 网站运行时间的设置 -->
<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>  Sometimes your whole life boils down to one insame move.
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("11/05/2022 00:00:00");//此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
}
setInterval("createtime()",250);
</script>
    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"renmale-lv","repo":"renmale-lv.github.io","client_id":"a7032a206391d1242a3c","client_secret":"5beb16ecce13a96a943bce7252eab7ab77218b9d","admin_user":"renmale-lv","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"zh-CN","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"d1546d731a9f30cc80127d57142a482b"}</script>
<script src="/js/third-party/comments/gitalk.js"></script>

</body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/clicklove.js"></script>
